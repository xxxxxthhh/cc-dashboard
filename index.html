<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel Strategy Dashboard</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e14;--card:#12171f;--border:#1e2733;--text:#c9d1d9;--dim:#6e7681;--green:#3fb950;--red:#f85149;--blue:#58a6ff;--yellow:#d29922;--purple:#bc8cff;--cyan:#39d2c0;--green-bg:rgba(63,185,80,.1);--red-bg:rgba(248,81,73,.1);--blue-bg:rgba(88,166,255,.1);--yellow-bg:rgba(210,153,34,.1);--purple-bg:rgba(188,140,255,.1);--cyan-bg:rgba(57,210,192,.1)}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','Segoe UI',sans-serif;padding:20px;max-width:1200px;margin:0 auto;line-height:1.5}
#lock-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;height:80vh;animation:fadeIn .5s}
#lock-screen h1{font-size:56px;margin-bottom:24px}
#lock-screen input{background:var(--card);border:2px solid var(--border);border-radius:12px;color:var(--text);font-size:28px;padding:14px 24px;width:200px;text-align:center;letter-spacing:10px;outline:none;transition:border-color .2s}
#lock-screen input:focus{border-color:var(--blue)}
#lock-screen .error{color:var(--red);font-size:13px;margin-top:8px;height:20px}
#dashboard{display:none;animation:fadeIn .6s}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

/* Header */
.header{margin-bottom:28px}
.header h1{font-size:26px;font-weight:700;background:linear-gradient(135deg,var(--blue),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:inline}
.header .sub{color:var(--dim);font-size:13px;margin-top:4px}

/* Nav tabs */
.nav{display:flex;gap:4px;margin-bottom:24px;border-bottom:1px solid var(--border);padding-bottom:0;overflow-x:auto}
.nav button{background:none;border:none;color:var(--dim);font-size:13px;padding:10px 16px;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap}
.nav button:hover{color:var(--text)}
.nav button.active{color:var(--blue);border-bottom-color:var(--blue)}

/* Sections */
.section{display:none}.section.active{display:block;animation:fadeIn .3s}

/* Summary grid */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-bottom:24px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;transition:transform .15s,border-color .15s}
.card:hover{transform:translateY(-2px);border-color:rgba(88,166,255,.3)}
.card .label{color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.card .value{font-size:22px;font-weight:700}
.card .sub-value{font-size:11px;color:var(--dim);margin-top:2px}
.green{color:var(--green)}.red{color:var(--red)}.blue{color:var(--blue)}.yellow{color:var(--yellow)}.purple{color:var(--purple)}.cyan{color:var(--cyan)}

/* Tables */
table{width:100%;border-collapse:collapse;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:16px;font-size:13px}
th{background:rgba(30,39,51,.8);color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;padding:10px 14px;text-align:left;font-weight:600}
td{padding:10px 14px;border-top:1px solid var(--border)}
tr:hover{background:rgba(88,166,255,.03)}
.ticker{font-weight:700;color:var(--text)}

/* Tags */
.tag{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600}
.tag-green{background:var(--green-bg);color:var(--green)}
.tag-red{background:var(--red-bg);color:var(--red)}
.tag-blue{background:var(--blue-bg);color:var(--blue)}
.tag-yellow{background:var(--yellow-bg);color:var(--yellow)}
.tag-purple{background:var(--purple-bg);color:var(--purple)}
.tag-cyan{background:var(--cyan-bg);color:var(--cyan)}
.tag-dim{background:rgba(110,118,129,.1);color:var(--dim)}

/* DTE bar */
.dte-bar{width:100%;height:4px;background:var(--border);border-radius:2px;overflow:hidden;margin-top:4px}
.dte-fill{height:100%;border-radius:2px;transition:width .3s}

/* Wheel tracker */
.wheel-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-bottom:24px}
.wheel-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;position:relative;overflow:hidden}
.wheel-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.wheel-card.phase-csp::before{background:linear-gradient(90deg,var(--purple),var(--blue))}
.wheel-card.phase-cc::before{background:linear-gradient(90deg,var(--green),var(--cyan))}
.wheel-card.phase-cc-exit::before{background:linear-gradient(90deg,var(--yellow),var(--red))}
.wheel-card.phase-cc-locked::before{background:linear-gradient(90deg,var(--red),var(--yellow))}
.wheel-card .wc-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.wheel-card .wc-ticker{font-size:18px;font-weight:700}
.wheel-card .wc-detail{color:var(--dim);font-size:12px}
.wheel-card .wc-note{font-size:12px;margin-top:4px}

/* Phase flow */
.phase-flow{display:flex;align-items:center;gap:6px;margin:20px 0}
.phase-step{padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;opacity:.3}
.phase-step.active{opacity:1}
.phase-step.step-csp{background:var(--purple-bg);color:var(--purple)}
.phase-step.step-assign{background:var(--yellow-bg);color:var(--yellow)}
.phase-step.step-cc{background:var(--green-bg);color:var(--green)}
.phase-arrow{color:var(--dim);font-size:10px;opacity:.4}

/* Section headers */
.sh{display:flex;align-items:center;gap:10px;margin:28px 0 14px;padding-bottom:10px;border-bottom:1px solid var(--border)}
.sh h2{font-size:15px;font-weight:600;color:var(--text)}
.sh .count{font-size:12px;color:var(--dim);background:var(--border);padding:2px 8px;border-radius:10px}

/* Opt changes */
.opt-item{display:flex;align-items:center;gap:10px;padding:8px 0;font-size:13px;border-bottom:1px solid var(--border)}
.opt-item:last-child{border-bottom:none}
.opt-badge{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;min-width:56px;text-align:center}
.opt-badge.done{background:var(--green-bg);color:var(--green)}
.opt-badge.active{background:var(--blue-bg);color:var(--blue)}
.opt-badge.pending{background:var(--yellow-bg);color:var(--yellow)}

/* Compare */
.compare{display:grid;grid-template-columns:1fr 50px 1fr;gap:0;margin:20px 0}
.compare-box{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:24px;text-align:center}
.compare-arrow{display:flex;align-items:center;justify-content:center;font-size:24px;color:var(--blue)}
.compare-box .big{font-size:30px;font-weight:700;margin:8px 0}
.compare-box .sub{color:var(--dim);font-size:12px}

/* Note */
.note-box{background:var(--card);border-left:3px solid var(--yellow);padding:12px 16px;margin:16px 0;font-size:13px;color:var(--yellow);border-radius:0 12px 12px 0}

/* Responsive */
@media(max-width:640px){
  body{padding:12px}
  .grid{grid-template-columns:repeat(2,1fr);gap:8px}
  .card .value{font-size:18px}
  .wheel-grid{grid-template-columns:1fr}
  table{font-size:12px}
  th,td{padding:8px 10px}
  .compare{grid-template-columns:1fr;gap:8px}
  .compare-arrow{transform:rotate(90deg)}
}
</style>
</head>
<body>

<div id="lock-screen">
<h1>ğŸ”’</h1>
<input type="password" id="pwd" maxlength="4" placeholder="Â·Â·Â·Â·" autofocus>
<div class="error" id="pwd-error"></div>
</div>

<div id="dashboard">
<div class="header">
<h1>ğŸ´ Wheel Strategy Dashboard</h1>
<p class="sub">Theta Gang æ”¶ç§Ÿè¿½è¸ª Â· <span id="update-date">â€”</span></p>
</div>

<div class="nav" id="nav">
<button class="active" data-tab="overview">æ€»è§ˆ</button>
<button data-tab="wheel">Wheel è¿½è¸ª</button>
<button data-tab="cc">Covered Calls</button>
<button data-tab="csp">Cash-Secured Puts</button>
<button data-tab="closed">å·²å®ç°æ”¶ç›Š</button>
<button data-tab="idle">é—²ç½®ä»“ä½</button>
<button data-tab="decision">ğŸ¯ å†³ç­–</button>
<button data-tab="optimize">ä¼˜åŒ–æ–¹æ¡ˆ</button>
</div>

<!-- Overview -->
<div class="section active" id="tab-overview">
<div class="grid" id="summary-cards"></div>
<div class="sh"><h2>ğŸ”„ Wheel çŠ¶æ€ä¸€è§ˆ</h2></div>
<div class="wheel-grid" id="wheel-overview"></div>
</div>

<!-- Wheel Tracker -->
<div class="section" id="tab-wheel">
<div class="phase-flow">
<div class="phase-step step-csp">Sell Put</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign æ¥è‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-cc">Sell Call</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign å‡ºè‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-csp">Sell Put â™»ï¸</div>
</div>
<div class="wheel-grid" id="wheel-cards"></div>
</div>

<!-- CC -->
<div class="section" id="tab-cc">
<div class="sh"><h2>ğŸ“Š Covered Call æŒä»“</h2><span class="count" id="cc-count">0</span></div>
<table id="cc-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>æˆæœ¬</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- CSP -->
<div class="section" id="tab-csp">
<div class="sh"><h2>ğŸ’ Cash-Secured Put æŒä»“</h2><span class="count" id="csp-count">0</span></div>
<table id="csp-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>ä¿è¯é‡‘</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Closed -->
<div class="section" id="tab-closed">
<div class="grid" id="realized-cards"></div>
<div class="sh"><h2>ğŸ’° å·²å¹³ä»“è®°å½•</h2><span class="count" id="closed-count">0</span></div>
<table id="closed-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>å¼€ä»“</th><th>å¹³ä»“</th><th>å¤©æ•°</th><th>æƒåˆ©é‡‘</th><th>ç»“æœ</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Idle -->
<div class="section" id="tab-idle">
<div class="sh"><h2>ğŸ’¤ æœªå¼€ä»“ä½ï¼ˆé—²ç½®èµ„é‡‘ï¼‰</h2></div>
<table id="idle-table"><thead><tr>
<th>æ ‡çš„</th><th>è‚¡æ•°</th><th>å‡ä»·</th><th>å¸‚å€¼</th><th>å¯å¼€CC</th><th>å¤‡æ³¨</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Decision -->
<div class="section" id="tab-decision">
<div class="grid" id="decision-summary"></div>

<div class="sh"><h2>âš¡ æœ¬å‘¨æ“ä½œå»ºè®®</h2></div>
<div id="weekly-plan" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>

<div class="sh"><h2>ğŸ“Š 80% æ­¢ç›ˆè¿½è¸ª</h2><span class="count" id="profit-count">0</span></div>
<table id="profit-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>å¼€ä»“æƒåˆ©é‡‘</th><th>å½“å‰ä»·å€¼</th><th>ç›ˆåˆ©%</th><th>ä¿¡å·</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>â° åˆ°æœŸæé†’</h2><span class="count" id="expiry-count">0</span></div>
<table id="expiry-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>çŠ¶æ€</th><th>å»ºè®®</th><th>ä¸‹ä¸€æ­¥</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ¯ ä¸‹å‘¨æœ€ä¼˜ CSP å€™é€‰</h2><span class="count" id="csp-cand-count">0</span></div>
<table id="csp-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th><th>è¯„åˆ†</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“ˆ CC å¼€ä»“å€™é€‰ï¼ˆæœªè¦†ç›–æŒä»“ï¼‰</h2><span class="count" id="cc-cand-count">0</span></div>
<table id="cc-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“Š IV æ’è¡Œ</h2></div>
<div class="grid" id="iv-ranking-grid"></div>

<div class="sh"><h2>ğŸ’° èµ„é‡‘æ•ˆç‡</h2></div>
<div class="grid" id="capital-eff-grid"></div>
</div>

<!-- Optimize -->
<div class="section" id="tab-optimize">
<div class="note-box">é›†ä¸­åˆ°é«˜ IV æ ‡çš„ï¼Œæœ€å¤§åŒ– Wheel æ”¶ç§Ÿæ•ˆç‡ã€‚çŸ­å‘¨æœŸ 5-7 DTE ä¼˜å…ˆã€‚</div>
<div class="sh"><h2>ğŸ”„ æ“ä½œè¿›åº¦</h2></div>
<div id="opt-changes" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>
<div class="sh"><h2>ğŸ“ˆ å½“å‰ vs ä¼˜åŒ–å</h2></div>
<div class="compare">
<div class="compare-box"><div class="sub">å½“å‰å¹´åŒ–æ”¶å…¥</div><div class="big yellow" id="cur-income">â€”</div><div class="sub" id="cur-yield">â€”</div></div>
<div class="compare-arrow">â†’</div>
<div class="compare-box"><div class="sub">ä¼˜åŒ–åå¹´åŒ–æ”¶å…¥</div><div class="big green" id="opt-income">â€”</div><div class="sub" id="opt-yield">â€”</div></div>
</div>
</div>
</div>

<script>
const ENC = {"salt":"Ehpmdg2NPDGuQBzyDzgYqg==","iv":"Xq5J4wXGRhaKL7HG","tag":"PHzhXT/MNG7Zv7s2xDWEDw==","data":"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"};

function b64(s){return Uint8Array.from(atob(s),c=>c.charCodeAt(0))}

async function decrypt(pwd){
  const enc=new TextEncoder();
  const km=await crypto.subtle.importKey('raw',enc.encode(pwd),{name:'PBKDF2'},false,['deriveKey']);
  const key=await crypto.subtle.deriveKey({name:'PBKDF2',salt:b64(ENC.salt),iterations:100000,hash:'SHA-256'},km,{name:'AES-GCM',length:256},false,['decrypt']);
  const ct=b64(ENC.data),tag=b64(ENC.tag);
  const combined=new Uint8Array(ct.length+tag.length);
  combined.set(ct);combined.set(tag,ct.length);
  return JSON.parse(new TextDecoder().decode(await crypto.subtle.decrypt({name:'AES-GCM',iv:b64(ENC.iv)},key,combined)));
}

document.getElementById('pwd').addEventListener('input',async function(){
  if(this.value.length===4){
    try{
      const data=await decrypt(this.value);
      document.getElementById('lock-screen').style.display='none';
      document.getElementById('dashboard').style.display='block';
      render(data);
    }catch(e){
      document.getElementById('pwd-error').textContent='å¯†ç é”™è¯¯';
      this.value='';
    }
  }
});

// Tab navigation
document.getElementById('nav').addEventListener('click',e=>{
  if(e.target.tagName!=='BUTTON')return;
  document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  e.target.classList.add('active');
  document.getElementById('tab-'+e.target.dataset.tab).classList.add('active');
});

const fmt=n=>'$'+n.toLocaleString('en-US',{minimumFractionDigits:0,maximumFractionDigits:0});
const fmtPct=n=>n.toFixed(1)+'%';
const days=(a,b)=>Math.round((new Date(b)-new Date(a))/864e5);

function dteTag(dte,total){
  const pct=Math.max(0,Math.min(100,(1-dte/total)*100));
  let color=dte<=3?'var(--red)':dte<=7?'var(--yellow)':'var(--green)';
  return `<div>${dte}å¤©</div><div class="dte-bar"><div class="dte-fill" style="width:${pct}%;background:${color}"></div></div>`;
}

function statusTag(text,type){return `<span class="tag tag-${type}">${text}</span>`}

function render(D){
  const today=D.updatedAt;
  document.getElementById('update-date').textContent=today;

  // === Summary ===
  let totalCCPremium=0,totalCSPPremium=0,totalRealized=0,totalCCCost=0,totalCSPCollateral=0,totalIdleCost=0;
  D.ccPositions.forEach(p=>{totalCCPremium+=p.premium;totalCCCost+=p.costPerShare*100});
  D.cspPositions.forEach(p=>{totalCSPPremium+=p.premium;totalCSPCollateral+=p.collateral});
  D.closedTrades.forEach(t=>totalRealized+=t.premium);
  D.idlePositions.forEach(p=>totalIdleCost+=p.shares*p.cost);

  const activePremium=totalCCPremium+totalCSPPremium;
  const totalCap=totalCCCost+totalCSPCollateral+totalIdleCost;
  const daysYTD=days('2026-01-01',today);
  const annRealized=daysYTD>0?totalRealized*(365/daysYTD):0;

  const cards=[
    {label:'æ´»è·ƒæƒåˆ©é‡‘',value:fmt(Math.round(activePremium)),cls:'green',sub:`CC ${fmt(Math.round(totalCCPremium))} + CSP ${fmt(Math.round(totalCSPPremium))}`},
    {label:'YTD å·²å®ç°',value:fmt(Math.round(totalRealized)),cls:'green',sub:`${D.closedTrades.length}ç¬” Â· å¹´åŒ–æ¨ç®— ${fmt(Math.round(annRealized))}`},
    {label:'æ´»è·ƒCC',value:D.ccPositions.length+'å¼ ',cls:'cyan',sub:fmt(Math.round(totalCCCost))+' è¦†ç›–'},
    {label:'æ´»è·ƒCSP',value:D.cspPositions.length+'å¼ ',cls:'purple',sub:fmt(Math.round(totalCSPCollateral))+' ä¿è¯é‡‘'},
    {label:'Wheel æ ‡çš„',value:D.wheelCycles.length+'ä¸ª',cls:'blue',sub:'CSP '+D.wheelCycles.filter(w=>w.phase==='csp').length+' Â· CC '+D.wheelCycles.filter(w=>w.phase.startsWith('cc')).length},
    {label:'é—²ç½®èµ„é‡‘',value:fmt(Math.round(totalIdleCost)),cls:'yellow',sub:D.idlePositions.length+'ä¸ªä»“ä½'}
  ];
  const sc=document.getElementById('summary-cards');
  cards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
    sc.appendChild(d);
  });

  // === Wheel Overview (on overview tab) ===
  renderWheelCards(D.wheelCycles,'wheel-overview');

  // === Wheel Tracker tab ===
  renderWheelCards(D.wheelCycles,'wheel-cards');

  // === CC Table ===
  document.getElementById('cc-count').textContent=D.ccPositions.length+'å¼ ';
  const ccTb=document.querySelector('#cc-table tbody');
  D.ccPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const cost100=p.costPerShare*100;
    const yPer=(p.premium/cost100)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='green'}
    else if(ann>15){st='æ­£å¸¸';sc2='green'}
    else{st='åä½';sc2='yellow'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(Math.round(cost100))}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    ccTb.appendChild(tr);
  });

  // === CSP Table ===
  document.getElementById('csp-count').textContent=D.cspPositions.length+'å¼ ';
  const cspTb=document.querySelector('#csp-table tbody');
  D.cspPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const yPer=(p.premium/p.collateral)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='purple'}
    else{st='æ­£å¸¸';sc2='green'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(p.collateral)}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    cspTb.appendChild(tr);
  });

  // === Closed Trades ===
  document.getElementById('closed-count').textContent=D.closedTrades.length+'ç¬”';
  const rCards=[
    {label:'YTD å·²å®ç°æ”¶ç›Š',value:fmt(Math.round(totalRealized)),cls:'green'},
    {label:'å·²å¹³ä»“ç¬”æ•°',value:D.closedTrades.length+'ç¬”',cls:'blue'},
    {label:'å¹´åŒ–æ¨ç®—',value:fmt(Math.round(annRealized)),cls:'green'}
  ];
  const rc=document.getElementById('realized-cards');
  rCards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>`;
    rc.appendChild(d);
  });
  const ctb=document.querySelector('#closed-table tbody');
  D.closedTrades.forEach(t=>{
    const d=days(t.openDate,t.closeDate);
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${t.ticker}</td><td>${statusTag(t.type,t.type==='CC'?'cyan':'purple')}</td><td>$${t.strike}</td><td>${t.openDate.slice(5)}</td><td>${t.closeDate.slice(5)}</td><td>${d}å¤©</td><td class="green">${fmt(t.premium)}</td><td>${statusTag(t.assigned?'è¢«Assign':'åˆ°æœŸå½’é›¶',t.assigned?'yellow':'green')}</td>`;
    ctb.appendChild(tr);
  });

  // === Idle ===
  const itb=document.querySelector('#idle-table tbody');
  D.idlePositions.forEach(p=>{
    const mv=p.shares*p.cost;
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>${p.shares}</td><td>$${p.cost}</td><td>${fmt(Math.round(mv))}</td><td>${p.canCC?statusTag('å¯ä»¥','green'):statusTag('ä¸è¶³100è‚¡','red')}</td><td style="color:var(--dim)">${p.note}</td>`;
    itb.appendChild(tr);
  });

  // === Decision Tab ===
  if(D.decision){
    const dec=D.decision;

    // Summary cards
    const dsc=document.getElementById('decision-summary');
    const ce=dec.capitalEfficiency||{};
    const dCards=[
      {label:'èµ„é‡‘åˆ©ç”¨ç‡',value:fmtPct(ce.utilization||0),cls:ce.utilization>60?'green':'yellow',sub:`éƒ¨ç½² ${fmt(ce.deployedCapital||0)} / æ€»è®¡ ${fmt(ce.totalCapital||0)}`},
      {label:'å¹´åŒ–æ”¶ç§Ÿæ”¶å…¥',value:fmt(ce.totalAnnualPremium||0),cls:'green',sub:`CC ${fmt(ce.ccAnnualPremium||0)} + CSP ${fmt(ce.cspAnnualPremium||0)}`},
      {label:'ç»„åˆå¹´åŒ–æ”¶ç›Šç‡',value:fmtPct(ce.totalYield||0),cls:ce.totalYield>20?'green':'yellow',sub:`å·¥ä½œèµ„é‡‘å¹´åŒ– ${fmtPct(ce.workingYield||0)}`},
      {label:'æ­»é’±å æ¯”',value:fmtPct(ce.deadMoneyPct||0),cls:ce.deadMoneyPct>10?'red':'green',sub:fmt(ce.deadMoney||0)+' é—²ç½®'},
      {label:'åˆ°æœŸæé†’',value:(dec.expiringAlerts||[]).length+'ä¸ª',cls:'yellow',sub:'æœ¬å‘¨éœ€å…³æ³¨'},
      {label:'CSP å€™é€‰',value:(dec.cspCandidates||[]).length+'ä¸ª',cls:'purple',sub:'ä¸‹å‘¨å¯å¼€ä»“'},
    ];
    dCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
      dsc.appendChild(d);
    });

    // Weekly plan
    const wp=document.getElementById('weekly-plan');
    const plans=dec.weeklyPlan||[];
    if(plans.length===0){
      wp.innerHTML='<div style="color:var(--dim);padding:8px">æš‚æ— æ“ä½œå»ºè®®</div>';
    }else{
      plans.forEach(p=>{
        const d=document.createElement('div');d.className='opt-item';
        const urgCls=p.urgency==='high'?'active':p.urgency==='medium'?'pending':'done';
        const urgLabel=p.urgency==='high'?'ç´§æ€¥':p.urgency==='medium'?'å…³æ³¨':'å»ºè®®';
        const catIcon={expiry:'â°',opportunity:'ğŸ¯',efficiency:'ğŸ’°',profit:'ğŸ¯',risk:'âš ï¸'}[p.category]||'ğŸ“‹';
        d.innerHTML=`<span class="opt-badge ${urgCls}">${urgLabel}</span><span>${catIcon} ${p.action}</span>${p.detail?'<div style="color:var(--dim);font-size:11px;margin-left:66px">â†’ '+p.detail+'</div>':''}`;
        wp.appendChild(d);
      });
    }

    // Profit tracking (80% take-profit)
    const pa=dec.profitAlerts||[];
    document.getElementById('profit-count').textContent=pa.length+'ä¸ª';
    const ptb=document.querySelector('#profit-table tbody');
    if(pa.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="8" style="color:var(--dim);text-align:center">æ— å®æ—¶æ•°æ®ï¼ˆéœ€ Futu OpenD åœ¨çº¿æ—¶é‡‡é›†ï¼‰</td>';
      ptb.appendChild(tr);
    }else{
      pa.forEach(a=>{
        const tr=document.createElement('tr');
        const pctCls=a.profitPct>=80?'green':a.profitPct>=0?'blue':'red';
        const sigTag=a.signal==='take_profit'?statusTag('ğŸ¯ æ­¢ç›ˆ','green'):a.signal==='approaching'?statusTag('æ¥è¿‘','blue'):a.signal==='underwater'?statusTag('æµ®äº','red'):statusTag('æŒæœ‰','dim');
        tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td class="green">${fmt(a.entryPremium)}</td><td>${fmt(a.currentValue)}</td><td class="${pctCls}"><strong>${a.profitPct>0?'+':''}${a.profitPct}%</strong></td><td>${sigTag}<div style="font-size:11px;color:var(--dim);margin-top:2px">${a.message}</div></td>`;
        ptb.appendChild(tr);
      });
    }

    // Expiring alerts
    const ea=dec.expiringAlerts||[];
    document.getElementById('expiry-count').textContent=ea.length+'ä¸ª';
    const etb=document.querySelector('#expiry-table tbody');
    ea.forEach(a=>{
      const tr=document.createElement('tr');
      const urgTag=a.urgency==='high'?statusTag('ç´§æ€¥','red'):statusTag('å…³æ³¨','yellow');
      tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td>${a.dte}å¤©</td><td class="green">${fmt(a.premium)}</td><td>${urgTag}</td><td style="color:var(--dim);font-size:12px">${a.action}</td><td style="font-size:12px">${a.nextStep||''}</td>`;
      etb.appendChild(tr);
    });

    // CSP candidates
    const cc2=dec.cspCandidates||[];
    document.getElementById('csp-cand-count').textContent=cc2.length+'ä¸ª';
    const cctb=document.querySelector('#csp-cand-table tbody');
    cc2.forEach((c,i)=>{
      const tr=document.createElement('tr');
      const signal=c.annYield>=200?'ğŸ”¥':c.annYield>=100?'ğŸ’°':'ğŸ‘€';
      const scoreColor=c.score>=100?'green':c.score>=50?'yellow':'dim';
      tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong> ${signal}</td><td>${c.oi.toLocaleString()}</td><td>${statusTag(c.score,scoreColor)}</td>`;
      cctb.appendChild(tr);
    });

    // CC candidates
    const ccCand=dec.ccCandidates||[];
    document.getElementById('cc-cand-count').textContent=ccCand.length+'ä¸ª';
    const ccCandTb=document.querySelector('#cc-cand-table tbody');
    if(ccCand.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="9" style="color:var(--dim);text-align:center">æ‰€æœ‰æŒä»“å·²æœ‰ CC è¦†ç›– âœ…</td>';
      ccCandTb.appendChild(tr);
    }else{
      ccCand.forEach(c=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong></td><td>${c.oi.toLocaleString()}</td>`;
        ccCandTb.appendChild(tr);
      });
    }

    // IV rankings (with change indicator)
    const ivg=document.getElementById('iv-ranking-grid');
    const ivr=dec.ivRankings||[];
    ivr.slice(0,8).forEach(r=>{
      const d=document.createElement('div');d.className='card';
      const cls=r.iv>=70?'red':r.iv>=50?'yellow':'dim';
      const signal=r.iv>=70?'ğŸ”¥':r.iv>=50?'ğŸ’°':'';
      const change=r.ivChange!=null?(r.ivChange>0?`<span class="red">+${r.ivChange}%</span>`:`<span class="green">${r.ivChange}%</span>`):'';
      d.innerHTML=`<div class="label">${r.ticker} ${signal}</div><div class="value ${cls}">${r.iv}%</div><div class="sub-value">$${r.price} ${change}</div>`;
      ivg.appendChild(d);
    });

    // Capital efficiency
    const ceg=document.getElementById('capital-eff-grid');
    const ceCards=[
      {label:'æ€»èµ„æœ¬',value:fmt(ce.totalCapital||0),cls:'blue'},
      {label:'å·²éƒ¨ç½²',value:fmt(ce.deployedCapital||0),cls:'green',sub:fmtPct(ce.utilization||0)+' åˆ©ç”¨ç‡'},
      {label:'é—²ç½®èµ„é‡‘',value:fmt(ce.deadMoney||0),cls:ce.deadMoneyPct>10?'red':'dim'},
      {label:'ç°é‡‘',value:fmt(ce.cash||0),cls:'blue'},
    ];
    ceCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>${c.sub?'<div class="sub-value">'+c.sub+'</div>':''}`;
      ceg.appendChild(d);
    });
  }else{
    // No decision data
    const dsc=document.getElementById('decision-summary');
    dsc.innerHTML='<div class="card" style="grid-column:1/-1"><div class="label">å†³ç­–æ•°æ®</div><div class="value yellow">æœªç”Ÿæˆ</div><div class="sub-value">è¿è¡Œ python decision_engine.py ç”Ÿæˆ</div></div>';
  }

  // === Optimize ===
  const oc=document.getElementById('opt-changes');
  D.optChanges.forEach(c=>{
    const d=document.createElement('div');d.className='opt-item';
    d.innerHTML=`<span class="opt-badge ${c.cls}">${c.action}</span><span>${c.detail}</span>`;
    oc.appendChild(d);
  });

  // Compare
  const ccAnnual=D.ccPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const cspAnnual=D.cspPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const curIncome=Math.round(ccAnnual+cspAnnual);
  const curYield=totalCap>0?(curIncome/totalCap*100):0;
  const optAI=D.optEstimates.reduce((s,e)=>s+e.monthlyPremium*12,0);
  const optTC=D.optEstimates.reduce((s,e)=>s+e.cost,0);
  document.getElementById('cur-income').textContent=fmt(curIncome);
  document.getElementById('cur-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(curYield);
  document.getElementById('opt-income').textContent=fmt(optAI);
  document.getElementById('opt-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(optTC>0?optAI/optTC*100:0);
}

function renderWheelCards(cycles,containerId){
  const container=document.getElementById(containerId);
  cycles.forEach(w=>{
    const d=document.createElement('div');
    d.className=`wheel-card phase-${w.phase}`;
    const phaseLabel={csp:'Sell Put',cc:'Sell Call','cc-exit':'æ¸…é€€ä¸­','cc-locked':'è¿œæœŸé”å®š'}[w.phase]||w.phase;
    const phaseTag={csp:'purple',cc:'green','cc-exit':'yellow','cc-locked':'red'}[w.phase]||'dim';
    d.innerHTML=`
      <div class="wc-header">
        <span class="wc-ticker">${w.ticker}</span>
        ${statusTag(phaseLabel,phaseTag)}
      </div>
      <div class="wc-detail">${w.detail}</div>
      <div class="wc-note" style="color:var(--dim)">${w.note}</div>
    `;
    container.appendChild(d);
  });
}
</script>
</body>
</html>
