<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel Strategy Dashboard</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e14;--card:#12171f;--border:#1e2733;--text:#c9d1d9;--dim:#6e7681;--green:#3fb950;--red:#f85149;--blue:#58a6ff;--yellow:#d29922;--purple:#bc8cff;--cyan:#39d2c0;--green-bg:rgba(63,185,80,.1);--red-bg:rgba(248,81,73,.1);--blue-bg:rgba(88,166,255,.1);--yellow-bg:rgba(210,153,34,.1);--purple-bg:rgba(188,140,255,.1);--cyan-bg:rgba(57,210,192,.1)}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','Segoe UI',sans-serif;padding:20px;max-width:1200px;margin:0 auto;line-height:1.5}
#lock-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;height:80vh;animation:fadeIn .5s}
#lock-screen h1{font-size:56px;margin-bottom:24px}
#lock-screen input{background:var(--card);border:2px solid var(--border);border-radius:12px;color:var(--text);font-size:28px;padding:14px 24px;width:200px;text-align:center;letter-spacing:10px;outline:none;transition:border-color .2s}
#lock-screen input:focus{border-color:var(--blue)}
#lock-screen .error{color:var(--red);font-size:13px;margin-top:8px;height:20px}
#dashboard{display:none;animation:fadeIn .6s}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

/* Header */
.header{margin-bottom:28px}
.header h1{font-size:26px;font-weight:700;background:linear-gradient(135deg,var(--blue),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:inline}
.header .sub{color:var(--dim);font-size:13px;margin-top:4px}

/* Nav tabs */
.nav{display:flex;gap:4px;margin-bottom:24px;border-bottom:1px solid var(--border);padding-bottom:0;overflow-x:auto}
.nav button{background:none;border:none;color:var(--dim);font-size:13px;padding:10px 16px;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap}
.nav button:hover{color:var(--text)}
.nav button.active{color:var(--blue);border-bottom-color:var(--blue)}

/* Sections */
.section{display:none}.section.active{display:block;animation:fadeIn .3s}

/* Summary grid */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-bottom:24px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;transition:transform .15s,border-color .15s}
.card:hover{transform:translateY(-2px);border-color:rgba(88,166,255,.3)}
.card .label{color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.card .value{font-size:22px;font-weight:700}
.card .sub-value{font-size:11px;color:var(--dim);margin-top:2px}
.green{color:var(--green)}.red{color:var(--red)}.blue{color:var(--blue)}.yellow{color:var(--yellow)}.purple{color:var(--purple)}.cyan{color:var(--cyan)}

/* Tables */
table{width:100%;border-collapse:collapse;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:16px;font-size:13px}
th{background:rgba(30,39,51,.8);color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;padding:10px 14px;text-align:left;font-weight:600}
td{padding:10px 14px;border-top:1px solid var(--border)}
tr:hover{background:rgba(88,166,255,.03)}
.ticker{font-weight:700;color:var(--text)}

/* Tags */
.tag{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600}
.tag-green{background:var(--green-bg);color:var(--green)}
.tag-red{background:var(--red-bg);color:var(--red)}
.tag-blue{background:var(--blue-bg);color:var(--blue)}
.tag-yellow{background:var(--yellow-bg);color:var(--yellow)}
.tag-purple{background:var(--purple-bg);color:var(--purple)}
.tag-cyan{background:var(--cyan-bg);color:var(--cyan)}
.tag-dim{background:rgba(110,118,129,.1);color:var(--dim)}

/* DTE bar */
.dte-bar{width:100%;height:4px;background:var(--border);border-radius:2px;overflow:hidden;margin-top:4px}
.dte-fill{height:100%;border-radius:2px;transition:width .3s}

/* Wheel tracker */
.wheel-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-bottom:24px}
.wheel-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;position:relative;overflow:hidden}
.wheel-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.wheel-card.phase-csp::before{background:linear-gradient(90deg,var(--purple),var(--blue))}
.wheel-card.phase-cc::before{background:linear-gradient(90deg,var(--green),var(--cyan))}
.wheel-card.phase-cc-exit::before{background:linear-gradient(90deg,var(--yellow),var(--red))}
.wheel-card.phase-cc-locked::before{background:linear-gradient(90deg,var(--red),var(--yellow))}
.wheel-card .wc-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.wheel-card .wc-ticker{font-size:18px;font-weight:700}
.wheel-card .wc-detail{color:var(--dim);font-size:12px}
.wheel-card .wc-note{font-size:12px;margin-top:4px}

/* Phase flow */
.phase-flow{display:flex;align-items:center;gap:6px;margin:20px 0}
.phase-step{padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;opacity:.3}
.phase-step.active{opacity:1}
.phase-step.step-csp{background:var(--purple-bg);color:var(--purple)}
.phase-step.step-assign{background:var(--yellow-bg);color:var(--yellow)}
.phase-step.step-cc{background:var(--green-bg);color:var(--green)}
.phase-arrow{color:var(--dim);font-size:10px;opacity:.4}

/* Section headers */
.sh{display:flex;align-items:center;gap:10px;margin:28px 0 14px;padding-bottom:10px;border-bottom:1px solid var(--border)}
.sh h2{font-size:15px;font-weight:600;color:var(--text)}
.sh .count{font-size:12px;color:var(--dim);background:var(--border);padding:2px 8px;border-radius:10px}

/* Opt changes */
.opt-item{display:flex;align-items:center;gap:10px;padding:8px 0;font-size:13px;border-bottom:1px solid var(--border)}
.opt-item:last-child{border-bottom:none}
.opt-badge{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;min-width:56px;text-align:center}
.opt-badge.done{background:var(--green-bg);color:var(--green)}
.opt-badge.active{background:var(--blue-bg);color:var(--blue)}
.opt-badge.pending{background:var(--yellow-bg);color:var(--yellow)}

/* Compare */
.compare{display:grid;grid-template-columns:1fr 50px 1fr;gap:0;margin:20px 0}
.compare-box{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:24px;text-align:center}
.compare-arrow{display:flex;align-items:center;justify-content:center;font-size:24px;color:var(--blue)}
.compare-box .big{font-size:30px;font-weight:700;margin:8px 0}
.compare-box .sub{color:var(--dim);font-size:12px}

/* Note */
.note-box{background:var(--card);border-left:3px solid var(--yellow);padding:12px 16px;margin:16px 0;font-size:13px;color:var(--yellow);border-radius:0 12px 12px 0}

/* Responsive */
@media(max-width:640px){
  body{padding:12px}
  .grid{grid-template-columns:repeat(2,1fr);gap:8px}
  .card .value{font-size:18px}
  .wheel-grid{grid-template-columns:1fr}
  table{font-size:12px}
  th,td{padding:8px 10px}
  .compare{grid-template-columns:1fr;gap:8px}
  .compare-arrow{transform:rotate(90deg)}
}
</style>
</head>
<body>

<div id="lock-screen">
<h1>ğŸ”’</h1>
<input type="password" id="pwd" maxlength="4" placeholder="Â·Â·Â·Â·" autofocus>
<div class="error" id="pwd-error"></div>
</div>

<div id="dashboard">
<div class="header">
<h1>ğŸ´ Wheel Strategy Dashboard</h1>
<p class="sub">Theta Gang æ”¶ç§Ÿè¿½è¸ª Â· <span id="update-date">â€”</span></p>
</div>

<div class="nav" id="nav">
<button class="active" data-tab="overview">æ€»è§ˆ</button>
<button data-tab="wheel">Wheel è¿½è¸ª</button>
<button data-tab="cc">Covered Calls</button>
<button data-tab="csp">Cash-Secured Puts</button>
<button data-tab="closed">å·²å®ç°æ”¶ç›Š</button>
<button data-tab="idle">é—²ç½®ä»“ä½</button>
<button data-tab="decision">ğŸ¯ å†³ç­–</button>
<button data-tab="optimize">ä¼˜åŒ–æ–¹æ¡ˆ</button>
</div>

<!-- Overview -->
<div class="section active" id="tab-overview">
<div class="grid" id="summary-cards"></div>
<div class="sh"><h2>ğŸ”„ Wheel çŠ¶æ€ä¸€è§ˆ</h2></div>
<div class="wheel-grid" id="wheel-overview"></div>
</div>

<!-- Wheel Tracker -->
<div class="section" id="tab-wheel">
<div class="phase-flow">
<div class="phase-step step-csp">Sell Put</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign æ¥è‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-cc">Sell Call</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign å‡ºè‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-csp">Sell Put â™»ï¸</div>
</div>
<div class="wheel-grid" id="wheel-cards"></div>
</div>

<!-- CC -->
<div class="section" id="tab-cc">
<div class="sh"><h2>ğŸ“Š Covered Call æŒä»“</h2><span class="count" id="cc-count">0</span></div>
<table id="cc-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>æˆæœ¬</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- CSP -->
<div class="section" id="tab-csp">
<div class="sh"><h2>ğŸ’ Cash-Secured Put æŒä»“</h2><span class="count" id="csp-count">0</span></div>
<table id="csp-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>ä¿è¯é‡‘</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Closed -->
<div class="section" id="tab-closed">
<div class="grid" id="realized-cards"></div>
<div class="sh"><h2>ğŸ’° å·²å¹³ä»“è®°å½•</h2><span class="count" id="closed-count">0</span></div>
<table id="closed-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>å¼€ä»“</th><th>å¹³ä»“</th><th>å¤©æ•°</th><th>æƒåˆ©é‡‘</th><th>ç»“æœ</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Idle -->
<div class="section" id="tab-idle">
<div class="sh"><h2>ğŸ’¤ æœªå¼€ä»“ä½ï¼ˆé—²ç½®èµ„é‡‘ï¼‰</h2></div>
<table id="idle-table"><thead><tr>
<th>æ ‡çš„</th><th>è‚¡æ•°</th><th>å‡ä»·</th><th>å¸‚å€¼</th><th>å¯å¼€CC</th><th>å¤‡æ³¨</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Decision -->
<div class="section" id="tab-decision">
<div class="grid" id="decision-summary"></div>

<div class="sh"><h2>âš¡ æœ¬å‘¨æ“ä½œå»ºè®®</h2></div>
<div id="weekly-plan" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>

<div class="sh"><h2>ğŸ“Š 80% æ­¢ç›ˆè¿½è¸ª</h2><span class="count" id="profit-count">0</span></div>
<table id="profit-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>å¼€ä»“æƒåˆ©é‡‘</th><th>å½“å‰ä»·å€¼</th><th>ç›ˆåˆ©%</th><th>ä¿¡å·</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>â° åˆ°æœŸæé†’</h2><span class="count" id="expiry-count">0</span></div>
<table id="expiry-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>çŠ¶æ€</th><th>å»ºè®®</th><th>ä¸‹ä¸€æ­¥</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ¯ ä¸‹å‘¨æœ€ä¼˜ CSP å€™é€‰</h2><span class="count" id="csp-cand-count">0</span></div>
<table id="csp-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th><th>è¯„åˆ†</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“ˆ CC å¼€ä»“å€™é€‰ï¼ˆæœªè¦†ç›–æŒä»“ï¼‰</h2><span class="count" id="cc-cand-count">0</span></div>
<table id="cc-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“Š IV æ’è¡Œ</h2></div>
<div class="grid" id="iv-ranking-grid"></div>

<div class="sh"><h2>ğŸ’° èµ„é‡‘æ•ˆç‡</h2></div>
<div class="grid" id="capital-eff-grid"></div>
</div>

<!-- Optimize -->
<div class="section" id="tab-optimize">
<div class="note-box">é›†ä¸­åˆ°é«˜ IV æ ‡çš„ï¼Œæœ€å¤§åŒ– Wheel æ”¶ç§Ÿæ•ˆç‡ã€‚çŸ­å‘¨æœŸ 5-7 DTE ä¼˜å…ˆã€‚</div>
<div class="sh"><h2>ğŸ”„ æ“ä½œè¿›åº¦</h2></div>
<div id="opt-changes" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>
<div class="sh"><h2>ğŸ“ˆ å½“å‰ vs ä¼˜åŒ–å</h2></div>
<div class="compare">
<div class="compare-box"><div class="sub">å½“å‰å¹´åŒ–æ”¶å…¥</div><div class="big yellow" id="cur-income">â€”</div><div class="sub" id="cur-yield">â€”</div></div>
<div class="compare-arrow">â†’</div>
<div class="compare-box"><div class="sub">ä¼˜åŒ–åå¹´åŒ–æ”¶å…¥</div><div class="big green" id="opt-income">â€”</div><div class="sub" id="opt-yield">â€”</div></div>
</div>
</div>
</div>

<script>
const ENC = {"salt":"sizq/JlXcJSgFpASpIBRWw==","iv":"b0JzDGLtnr3r3CAL","tag":"JO9kFRrNqFcNr1GgLLt0cg==","data":"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"};

function b64(s){return Uint8Array.from(atob(s),c=>c.charCodeAt(0))}

async function decrypt(pwd){
  const enc=new TextEncoder();
  const km=await crypto.subtle.importKey('raw',enc.encode(pwd),{name:'PBKDF2'},false,['deriveKey']);
  const key=await crypto.subtle.deriveKey({name:'PBKDF2',salt:b64(ENC.salt),iterations:100000,hash:'SHA-256'},km,{name:'AES-GCM',length:256},false,['decrypt']);
  const ct=b64(ENC.data),tag=b64(ENC.tag);
  const combined=new Uint8Array(ct.length+tag.length);
  combined.set(ct);combined.set(tag,ct.length);
  return JSON.parse(new TextDecoder().decode(await crypto.subtle.decrypt({name:'AES-GCM',iv:b64(ENC.iv)},key,combined)));
}

document.getElementById('pwd').addEventListener('input',async function(){
  if(this.value.length===4){
    try{
      const data=await decrypt(this.value);
      document.getElementById('lock-screen').style.display='none';
      document.getElementById('dashboard').style.display='block';
      render(data);
    }catch(e){
      document.getElementById('pwd-error').textContent='å¯†ç é”™è¯¯';
      this.value='';
    }
  }
});

// Tab navigation
document.getElementById('nav').addEventListener('click',e=>{
  if(e.target.tagName!=='BUTTON')return;
  document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  e.target.classList.add('active');
  document.getElementById('tab-'+e.target.dataset.tab).classList.add('active');
});

const fmt=n=>'$'+n.toLocaleString('en-US',{minimumFractionDigits:0,maximumFractionDigits:0});
const fmtPct=n=>n.toFixed(1)+'%';
const days=(a,b)=>Math.round((new Date(b)-new Date(a))/864e5);

function dteTag(dte,total){
  const pct=Math.max(0,Math.min(100,(1-dte/total)*100));
  let color=dte<=3?'var(--red)':dte<=7?'var(--yellow)':'var(--green)';
  return `<div>${dte}å¤©</div><div class="dte-bar"><div class="dte-fill" style="width:${pct}%;background:${color}"></div></div>`;
}

function statusTag(text,type){return `<span class="tag tag-${type}">${text}</span>`}

function render(D){
  const today=D.updatedAt;
  document.getElementById('update-date').textContent=today;

  // === Summary ===
  let totalCCPremium=0,totalCSPPremium=0,totalRealized=0,totalCCCost=0,totalCSPCollateral=0,totalIdleCost=0;
  D.ccPositions.forEach(p=>{totalCCPremium+=p.premium;totalCCCost+=p.costPerShare*100});
  D.cspPositions.forEach(p=>{totalCSPPremium+=p.premium;totalCSPCollateral+=p.collateral});
  D.closedTrades.forEach(t=>totalRealized+=t.premium);
  D.idlePositions.forEach(p=>totalIdleCost+=p.shares*p.cost);

  const activePremium=totalCCPremium+totalCSPPremium;
  const totalCap=totalCCCost+totalCSPCollateral+totalIdleCost;
  const daysYTD=days('2026-01-01',today);
  const annRealized=daysYTD>0?totalRealized*(365/daysYTD):0;

  const cards=[
    {label:'æ´»è·ƒæƒåˆ©é‡‘',value:fmt(Math.round(activePremium)),cls:'green',sub:`CC ${fmt(Math.round(totalCCPremium))} + CSP ${fmt(Math.round(totalCSPPremium))}`},
    {label:'YTD å·²å®ç°',value:fmt(Math.round(totalRealized)),cls:'green',sub:`${D.closedTrades.length}ç¬” Â· å¹´åŒ–æ¨ç®— ${fmt(Math.round(annRealized))}`},
    {label:'æ´»è·ƒCC',value:D.ccPositions.length+'å¼ ',cls:'cyan',sub:fmt(Math.round(totalCCCost))+' è¦†ç›–'},
    {label:'æ´»è·ƒCSP',value:D.cspPositions.length+'å¼ ',cls:'purple',sub:fmt(Math.round(totalCSPCollateral))+' ä¿è¯é‡‘'},
    {label:'Wheel æ ‡çš„',value:D.wheelCycles.length+'ä¸ª',cls:'blue',sub:'CSP '+D.wheelCycles.filter(w=>w.phase==='csp').length+' Â· CC '+D.wheelCycles.filter(w=>w.phase.startsWith('cc')).length},
    {label:'é—²ç½®èµ„é‡‘',value:fmt(Math.round(totalIdleCost)),cls:'yellow',sub:D.idlePositions.length+'ä¸ªä»“ä½'}
  ];
  const sc=document.getElementById('summary-cards');
  cards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
    sc.appendChild(d);
  });

  // === Wheel Overview (on overview tab) ===
  renderWheelCards(D.wheelCycles,'wheel-overview');

  // === Wheel Tracker tab ===
  renderWheelCards(D.wheelCycles,'wheel-cards');

  // === CC Table ===
  document.getElementById('cc-count').textContent=D.ccPositions.length+'å¼ ';
  const ccTb=document.querySelector('#cc-table tbody');
  D.ccPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const cost100=p.costPerShare*100;
    const yPer=(p.premium/cost100)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='green'}
    else if(ann>15){st='æ­£å¸¸';sc2='green'}
    else{st='åä½';sc2='yellow'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(Math.round(cost100))}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    ccTb.appendChild(tr);
  });

  // === CSP Table ===
  document.getElementById('csp-count').textContent=D.cspPositions.length+'å¼ ';
  const cspTb=document.querySelector('#csp-table tbody');
  D.cspPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const yPer=(p.premium/p.collateral)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='purple'}
    else{st='æ­£å¸¸';sc2='green'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(p.collateral)}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    cspTb.appendChild(tr);
  });

  // === Closed Trades ===
  document.getElementById('closed-count').textContent=D.closedTrades.length+'ç¬”';
  const rCards=[
    {label:'YTD å·²å®ç°æ”¶ç›Š',value:fmt(Math.round(totalRealized)),cls:'green'},
    {label:'å·²å¹³ä»“ç¬”æ•°',value:D.closedTrades.length+'ç¬”',cls:'blue'},
    {label:'å¹´åŒ–æ¨ç®—',value:fmt(Math.round(annRealized)),cls:'green'}
  ];
  const rc=document.getElementById('realized-cards');
  rCards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>`;
    rc.appendChild(d);
  });
  const ctb=document.querySelector('#closed-table tbody');
  D.closedTrades.forEach(t=>{
    const d=days(t.openDate,t.closeDate);
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${t.ticker}</td><td>${statusTag(t.type,t.type==='CC'?'cyan':'purple')}</td><td>$${t.strike}</td><td>${t.openDate.slice(5)}</td><td>${t.closeDate.slice(5)}</td><td>${d}å¤©</td><td class="green">${fmt(t.premium)}</td><td>${statusTag(t.assigned?'è¢«Assign':'åˆ°æœŸå½’é›¶',t.assigned?'yellow':'green')}</td>`;
    ctb.appendChild(tr);
  });

  // === Idle ===
  const itb=document.querySelector('#idle-table tbody');
  D.idlePositions.forEach(p=>{
    const mv=p.shares*p.cost;
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>${p.shares}</td><td>$${p.cost}</td><td>${fmt(Math.round(mv))}</td><td>${p.canCC?statusTag('å¯ä»¥','green'):statusTag('ä¸è¶³100è‚¡','red')}</td><td style="color:var(--dim)">${p.note}</td>`;
    itb.appendChild(tr);
  });

  // === Decision Tab ===
  if(D.decision){
    const dec=D.decision;

    // Summary cards
    const dsc=document.getElementById('decision-summary');
    const ce=dec.capitalEfficiency||{};
    const dCards=[
      {label:'èµ„é‡‘åˆ©ç”¨ç‡',value:fmtPct(ce.utilization||0),cls:ce.utilization>60?'green':'yellow',sub:`éƒ¨ç½² ${fmt(ce.deployedCapital||0)} / æ€»è®¡ ${fmt(ce.totalCapital||0)}`},
      {label:'å¹´åŒ–æ”¶ç§Ÿæ”¶å…¥',value:fmt(ce.totalAnnualPremium||0),cls:'green',sub:`CC ${fmt(ce.ccAnnualPremium||0)} + CSP ${fmt(ce.cspAnnualPremium||0)}`},
      {label:'ç»„åˆå¹´åŒ–æ”¶ç›Šç‡',value:fmtPct(ce.totalYield||0),cls:ce.totalYield>20?'green':'yellow',sub:`å·¥ä½œèµ„é‡‘å¹´åŒ– ${fmtPct(ce.workingYield||0)}`},
      {label:'æ­»é’±å æ¯”',value:fmtPct(ce.deadMoneyPct||0),cls:ce.deadMoneyPct>10?'red':'green',sub:fmt(ce.deadMoney||0)+' é—²ç½®'},
      {label:'åˆ°æœŸæé†’',value:(dec.expiringAlerts||[]).length+'ä¸ª',cls:'yellow',sub:'æœ¬å‘¨éœ€å…³æ³¨'},
      {label:'CSP å€™é€‰',value:(dec.cspCandidates||[]).length+'ä¸ª',cls:'purple',sub:'ä¸‹å‘¨å¯å¼€ä»“'},
    ];
    dCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
      dsc.appendChild(d);
    });

    // Weekly plan
    const wp=document.getElementById('weekly-plan');
    const plans=dec.weeklyPlan||[];
    if(plans.length===0){
      wp.innerHTML='<div style="color:var(--dim);padding:8px">æš‚æ— æ“ä½œå»ºè®®</div>';
    }else{
      plans.forEach(p=>{
        const d=document.createElement('div');d.className='opt-item';
        const urgCls=p.urgency==='high'?'active':p.urgency==='medium'?'pending':'done';
        const urgLabel=p.urgency==='high'?'ç´§æ€¥':p.urgency==='medium'?'å…³æ³¨':'å»ºè®®';
        const catIcon={expiry:'â°',opportunity:'ğŸ¯',efficiency:'ğŸ’°',profit:'ğŸ¯',risk:'âš ï¸'}[p.category]||'ğŸ“‹';
        d.innerHTML=`<span class="opt-badge ${urgCls}">${urgLabel}</span><span>${catIcon} ${p.action}</span>${p.detail?'<div style="color:var(--dim);font-size:11px;margin-left:66px">â†’ '+p.detail+'</div>':''}`;
        wp.appendChild(d);
      });
    }

    // Profit tracking (80% take-profit)
    const pa=dec.profitAlerts||[];
    document.getElementById('profit-count').textContent=pa.length+'ä¸ª';
    const ptb=document.querySelector('#profit-table tbody');
    if(pa.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="8" style="color:var(--dim);text-align:center">æ— å®æ—¶æ•°æ®ï¼ˆéœ€ Futu OpenD åœ¨çº¿æ—¶é‡‡é›†ï¼‰</td>';
      ptb.appendChild(tr);
    }else{
      pa.forEach(a=>{
        const tr=document.createElement('tr');
        const pctCls=a.profitPct>=80?'green':a.profitPct>=0?'blue':'red';
        const sigTag=a.signal==='take_profit'?statusTag('ğŸ¯ æ­¢ç›ˆ','green'):a.signal==='approaching'?statusTag('æ¥è¿‘','blue'):a.signal==='underwater'?statusTag('æµ®äº','red'):statusTag('æŒæœ‰','dim');
        tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td class="green">${fmt(a.entryPremium)}</td><td>${fmt(a.currentValue)}</td><td class="${pctCls}"><strong>${a.profitPct>0?'+':''}${a.profitPct}%</strong></td><td>${sigTag}<div style="font-size:11px;color:var(--dim);margin-top:2px">${a.message}</div></td>`;
        ptb.appendChild(tr);
      });
    }

    // Expiring alerts
    const ea=dec.expiringAlerts||[];
    document.getElementById('expiry-count').textContent=ea.length+'ä¸ª';
    const etb=document.querySelector('#expiry-table tbody');
    ea.forEach(a=>{
      const tr=document.createElement('tr');
      const urgTag=a.urgency==='high'?statusTag('ç´§æ€¥','red'):statusTag('å…³æ³¨','yellow');
      tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td>${a.dte}å¤©</td><td class="green">${fmt(a.premium)}</td><td>${urgTag}</td><td style="color:var(--dim);font-size:12px">${a.action}</td><td style="font-size:12px">${a.nextStep||''}</td>`;
      etb.appendChild(tr);
    });

    // CSP candidates
    const cc2=dec.cspCandidates||[];
    document.getElementById('csp-cand-count').textContent=cc2.length+'ä¸ª';
    const cctb=document.querySelector('#csp-cand-table tbody');
    cc2.forEach((c,i)=>{
      const tr=document.createElement('tr');
      const signal=c.annYield>=200?'ğŸ”¥':c.annYield>=100?'ğŸ’°':'ğŸ‘€';
      const scoreColor=c.score>=100?'green':c.score>=50?'yellow':'dim';
      tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong> ${signal}</td><td>${c.oi.toLocaleString()}</td><td>${statusTag(c.score,scoreColor)}</td>`;
      cctb.appendChild(tr);
    });

    // CC candidates
    const ccCand=dec.ccCandidates||[];
    document.getElementById('cc-cand-count').textContent=ccCand.length+'ä¸ª';
    const ccCandTb=document.querySelector('#cc-cand-table tbody');
    if(ccCand.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="9" style="color:var(--dim);text-align:center">æ‰€æœ‰æŒä»“å·²æœ‰ CC è¦†ç›– âœ…</td>';
      ccCandTb.appendChild(tr);
    }else{
      ccCand.forEach(c=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong></td><td>${c.oi.toLocaleString()}</td>`;
        ccCandTb.appendChild(tr);
      });
    }

    // IV rankings (with change indicator)
    const ivg=document.getElementById('iv-ranking-grid');
    const ivr=dec.ivRankings||[];
    ivr.slice(0,8).forEach(r=>{
      const d=document.createElement('div');d.className='card';
      const cls=r.iv>=70?'red':r.iv>=50?'yellow':'dim';
      const signal=r.iv>=70?'ğŸ”¥':r.iv>=50?'ğŸ’°':'';
      const change=r.ivChange!=null?(r.ivChange>0?`<span class="red">+${r.ivChange}%</span>`:`<span class="green">${r.ivChange}%</span>`):'';
      d.innerHTML=`<div class="label">${r.ticker} ${signal}</div><div class="value ${cls}">${r.iv}%</div><div class="sub-value">$${r.price} ${change}</div>`;
      ivg.appendChild(d);
    });

    // Capital efficiency
    const ceg=document.getElementById('capital-eff-grid');
    const ceCards=[
      {label:'æ€»èµ„æœ¬',value:fmt(ce.totalCapital||0),cls:'blue'},
      {label:'å·²éƒ¨ç½²',value:fmt(ce.deployedCapital||0),cls:'green',sub:fmtPct(ce.utilization||0)+' åˆ©ç”¨ç‡'},
      {label:'é—²ç½®èµ„é‡‘',value:fmt(ce.deadMoney||0),cls:ce.deadMoneyPct>10?'red':'dim'},
      {label:'ç°é‡‘',value:fmt(ce.cash||0),cls:'blue'},
    ];
    ceCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>${c.sub?'<div class="sub-value">'+c.sub+'</div>':''}`;
      ceg.appendChild(d);
    });
  }else{
    // No decision data
    const dsc=document.getElementById('decision-summary');
    dsc.innerHTML='<div class="card" style="grid-column:1/-1"><div class="label">å†³ç­–æ•°æ®</div><div class="value yellow">æœªç”Ÿæˆ</div><div class="sub-value">è¿è¡Œ python decision_engine.py ç”Ÿæˆ</div></div>';
  }

  // === Optimize ===
  const oc=document.getElementById('opt-changes');
  D.optChanges.forEach(c=>{
    const d=document.createElement('div');d.className='opt-item';
    d.innerHTML=`<span class="opt-badge ${c.cls}">${c.action}</span><span>${c.detail}</span>`;
    oc.appendChild(d);
  });

  // Compare
  const ccAnnual=D.ccPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const cspAnnual=D.cspPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const curIncome=Math.round(ccAnnual+cspAnnual);
  const curYield=totalCap>0?(curIncome/totalCap*100):0;
  const optAI=D.optEstimates.reduce((s,e)=>s+e.monthlyPremium*12,0);
  const optTC=D.optEstimates.reduce((s,e)=>s+e.cost,0);
  document.getElementById('cur-income').textContent=fmt(curIncome);
  document.getElementById('cur-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(curYield);
  document.getElementById('opt-income').textContent=fmt(optAI);
  document.getElementById('opt-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(optTC>0?optAI/optTC*100:0);
}

function renderWheelCards(cycles,containerId){
  const container=document.getElementById(containerId);
  cycles.forEach(w=>{
    const d=document.createElement('div');
    d.className=`wheel-card phase-${w.phase}`;
    const phaseLabel={csp:'Sell Put',cc:'Sell Call','cc-exit':'æ¸…é€€ä¸­','cc-locked':'è¿œæœŸé”å®š'}[w.phase]||w.phase;
    const phaseTag={csp:'purple',cc:'green','cc-exit':'yellow','cc-locked':'red'}[w.phase]||'dim';
    d.innerHTML=`
      <div class="wc-header">
        <span class="wc-ticker">${w.ticker}</span>
        ${statusTag(phaseLabel,phaseTag)}
      </div>
      <div class="wc-detail">${w.detail}</div>
      <div class="wc-note" style="color:var(--dim)">${w.note}</div>
    `;
    container.appendChild(d);
  });
}
</script>
</body>
</html>
