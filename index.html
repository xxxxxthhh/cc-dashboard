<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel Strategy Dashboard</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e14;--card:#12171f;--border:#1e2733;--text:#c9d1d9;--dim:#6e7681;--green:#3fb950;--red:#f85149;--blue:#58a6ff;--yellow:#d29922;--purple:#bc8cff;--cyan:#39d2c0;--green-bg:rgba(63,185,80,.1);--red-bg:rgba(248,81,73,.1);--blue-bg:rgba(88,166,255,.1);--yellow-bg:rgba(210,153,34,.1);--purple-bg:rgba(188,140,255,.1);--cyan-bg:rgba(57,210,192,.1)}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','Segoe UI',sans-serif;padding:20px;max-width:1200px;margin:0 auto;line-height:1.5}
#lock-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;height:80vh;animation:fadeIn .5s}
#lock-screen h1{font-size:56px;margin-bottom:24px}
#lock-screen input{background:var(--card);border:2px solid var(--border);border-radius:12px;color:var(--text);font-size:28px;padding:14px 24px;width:200px;text-align:center;letter-spacing:10px;outline:none;transition:border-color .2s}
#lock-screen input:focus{border-color:var(--blue)}
#lock-screen .error{color:var(--red);font-size:13px;margin-top:8px;height:20px}
#dashboard{display:none;animation:fadeIn .6s}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

/* Header */
.header{margin-bottom:28px}
.header h1{font-size:26px;font-weight:700;background:linear-gradient(135deg,var(--blue),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:inline}
.header .sub{color:var(--dim);font-size:13px;margin-top:4px}

/* Nav tabs */
.nav{display:flex;gap:4px;margin-bottom:24px;border-bottom:1px solid var(--border);padding-bottom:0;overflow-x:auto}
.nav button{background:none;border:none;color:var(--dim);font-size:13px;padding:10px 16px;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap}
.nav button:hover{color:var(--text)}
.nav button.active{color:var(--blue);border-bottom-color:var(--blue)}

/* Sections */
.section{display:none}.section.active{display:block;animation:fadeIn .3s}

/* Summary grid */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-bottom:24px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;transition:transform .15s,border-color .15s}
.card:hover{transform:translateY(-2px);border-color:rgba(88,166,255,.3)}
.card .label{color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.card .value{font-size:22px;font-weight:700}
.card .sub-value{font-size:11px;color:var(--dim);margin-top:2px}
.green{color:var(--green)}.red{color:var(--red)}.blue{color:var(--blue)}.yellow{color:var(--yellow)}.purple{color:var(--purple)}.cyan{color:var(--cyan)}

/* Tables */
table{width:100%;border-collapse:collapse;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:16px;font-size:13px}
th{background:rgba(30,39,51,.8);color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;padding:10px 14px;text-align:left;font-weight:600}
td{padding:10px 14px;border-top:1px solid var(--border)}
tr:hover{background:rgba(88,166,255,.03)}
.ticker{font-weight:700;color:var(--text)}

/* Tags */
.tag{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600}
.tag-green{background:var(--green-bg);color:var(--green)}
.tag-red{background:var(--red-bg);color:var(--red)}
.tag-blue{background:var(--blue-bg);color:var(--blue)}
.tag-yellow{background:var(--yellow-bg);color:var(--yellow)}
.tag-purple{background:var(--purple-bg);color:var(--purple)}
.tag-cyan{background:var(--cyan-bg);color:var(--cyan)}
.tag-dim{background:rgba(110,118,129,.1);color:var(--dim)}

/* DTE bar */
.dte-bar{width:100%;height:4px;background:var(--border);border-radius:2px;overflow:hidden;margin-top:4px}
.dte-fill{height:100%;border-radius:2px;transition:width .3s}

/* Wheel tracker */
.wheel-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-bottom:24px}
.wheel-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;position:relative;overflow:hidden}
.wheel-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.wheel-card.phase-csp::before{background:linear-gradient(90deg,var(--purple),var(--blue))}
.wheel-card.phase-cc::before{background:linear-gradient(90deg,var(--green),var(--cyan))}
.wheel-card.phase-cc-exit::before{background:linear-gradient(90deg,var(--yellow),var(--red))}
.wheel-card.phase-cc-locked::before{background:linear-gradient(90deg,var(--red),var(--yellow))}
.wheel-card .wc-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.wheel-card .wc-ticker{font-size:18px;font-weight:700}
.wheel-card .wc-detail{color:var(--dim);font-size:12px}
.wheel-card .wc-note{font-size:12px;margin-top:4px}

/* Phase flow */
.phase-flow{display:flex;align-items:center;gap:6px;margin:20px 0}
.phase-step{padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;opacity:.3}
.phase-step.active{opacity:1}
.phase-step.step-csp{background:var(--purple-bg);color:var(--purple)}
.phase-step.step-assign{background:var(--yellow-bg);color:var(--yellow)}
.phase-step.step-cc{background:var(--green-bg);color:var(--green)}
.phase-arrow{color:var(--dim);font-size:10px;opacity:.4}

/* Section headers */
.sh{display:flex;align-items:center;gap:10px;margin:28px 0 14px;padding-bottom:10px;border-bottom:1px solid var(--border)}
.sh h2{font-size:15px;font-weight:600;color:var(--text)}
.sh .count{font-size:12px;color:var(--dim);background:var(--border);padding:2px 8px;border-radius:10px}

/* Opt changes */
.opt-item{display:flex;align-items:center;gap:10px;padding:8px 0;font-size:13px;border-bottom:1px solid var(--border)}
.opt-item:last-child{border-bottom:none}
.opt-badge{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;min-width:56px;text-align:center}
.opt-badge.done{background:var(--green-bg);color:var(--green)}
.opt-badge.active{background:var(--blue-bg);color:var(--blue)}
.opt-badge.pending{background:var(--yellow-bg);color:var(--yellow)}

/* Compare */
.compare{display:grid;grid-template-columns:1fr 50px 1fr;gap:0;margin:20px 0}
.compare-box{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:24px;text-align:center}
.compare-arrow{display:flex;align-items:center;justify-content:center;font-size:24px;color:var(--blue)}
.compare-box .big{font-size:30px;font-weight:700;margin:8px 0}
.compare-box .sub{color:var(--dim);font-size:12px}

/* Note */
.note-box{background:var(--card);border-left:3px solid var(--yellow);padding:12px 16px;margin:16px 0;font-size:13px;color:var(--yellow);border-radius:0 12px 12px 0}

/* Responsive */
@media(max-width:640px){
  body{padding:12px}
  .grid{grid-template-columns:repeat(2,1fr);gap:8px}
  .card .value{font-size:18px}
  .wheel-grid{grid-template-columns:1fr}
  table{font-size:12px}
  th,td{padding:8px 10px}
  .compare{grid-template-columns:1fr;gap:8px}
  .compare-arrow{transform:rotate(90deg)}
}
</style>
</head>
<body>

<div id="lock-screen">
<h1>ğŸ”’</h1>
<input type="password" id="pwd" maxlength="4" placeholder="Â·Â·Â·Â·" autofocus>
<div class="error" id="pwd-error"></div>
</div>

<div id="dashboard">
<div class="header">
<h1>ğŸ´ Wheel Strategy Dashboard</h1>
<p class="sub">Theta Gang æ”¶ç§Ÿè¿½è¸ª Â· <span id="update-date">â€”</span></p>
</div>

<div class="nav" id="nav">
<button class="active" data-tab="overview">æ€»è§ˆ</button>
<button data-tab="wheel">Wheel è¿½è¸ª</button>
<button data-tab="cc">Covered Calls</button>
<button data-tab="csp">Cash-Secured Puts</button>
<button data-tab="closed">å·²å®ç°æ”¶ç›Š</button>
<button data-tab="idle">é—²ç½®ä»“ä½</button>
<button data-tab="decision">ğŸ¯ å†³ç­–</button>
<button data-tab="optimize">ä¼˜åŒ–æ–¹æ¡ˆ</button>
</div>

<!-- Overview -->
<div class="section active" id="tab-overview">
<div class="grid" id="summary-cards"></div>
<div class="sh"><h2>ğŸ”„ Wheel çŠ¶æ€ä¸€è§ˆ</h2></div>
<div class="wheel-grid" id="wheel-overview"></div>
</div>

<!-- Wheel Tracker -->
<div class="section" id="tab-wheel">
<div class="phase-flow">
<div class="phase-step step-csp">Sell Put</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign æ¥è‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-cc">Sell Call</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign å‡ºè‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-csp">Sell Put â™»ï¸</div>
</div>
<div class="wheel-grid" id="wheel-cards"></div>
</div>

<!-- CC -->
<div class="section" id="tab-cc">
<div class="sh"><h2>ğŸ“Š Covered Call æŒä»“</h2><span class="count" id="cc-count">0</span></div>
<table id="cc-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>æˆæœ¬</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- CSP -->
<div class="section" id="tab-csp">
<div class="sh"><h2>ğŸ’ Cash-Secured Put æŒä»“</h2><span class="count" id="csp-count">0</span></div>
<table id="csp-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>ä¿è¯é‡‘</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Closed -->
<div class="section" id="tab-closed">
<div class="grid" id="realized-cards"></div>
<div class="sh"><h2>ğŸ’° å·²å¹³ä»“è®°å½•</h2><span class="count" id="closed-count">0</span></div>
<table id="closed-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>å¼€ä»“</th><th>å¹³ä»“</th><th>å¤©æ•°</th><th>æƒåˆ©é‡‘</th><th>ç»“æœ</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Idle -->
<div class="section" id="tab-idle">
<div class="sh"><h2>ğŸ’¤ æœªå¼€ä»“ä½ï¼ˆé—²ç½®èµ„é‡‘ï¼‰</h2></div>
<table id="idle-table"><thead><tr>
<th>æ ‡çš„</th><th>è‚¡æ•°</th><th>å‡ä»·</th><th>å¸‚å€¼</th><th>å¯å¼€CC</th><th>å¤‡æ³¨</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Decision -->
<div class="section" id="tab-decision">
<div class="grid" id="decision-summary"></div>

<div class="sh"><h2>âš¡ æœ¬å‘¨æ“ä½œå»ºè®®</h2></div>
<div id="weekly-plan" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>

<div class="sh"><h2>ğŸ“Š 80% æ­¢ç›ˆè¿½è¸ª</h2><span class="count" id="profit-count">0</span></div>
<table id="profit-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>å¼€ä»“æƒåˆ©é‡‘</th><th>å½“å‰ä»·å€¼</th><th>ç›ˆåˆ©%</th><th>ä¿¡å·</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>â° åˆ°æœŸæé†’</h2><span class="count" id="expiry-count">0</span></div>
<table id="expiry-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>çŠ¶æ€</th><th>å»ºè®®</th><th>ä¸‹ä¸€æ­¥</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ¯ ä¸‹å‘¨æœ€ä¼˜ CSP å€™é€‰</h2><span class="count" id="csp-cand-count">0</span></div>
<table id="csp-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th><th>è¯„åˆ†</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“ˆ CC å¼€ä»“å€™é€‰ï¼ˆæœªè¦†ç›–æŒä»“ï¼‰</h2><span class="count" id="cc-cand-count">0</span></div>
<table id="cc-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“Š IV æ’è¡Œ</h2></div>
<div class="grid" id="iv-ranking-grid"></div>

<div class="sh"><h2>ğŸ’° èµ„é‡‘æ•ˆç‡</h2></div>
<div class="grid" id="capital-eff-grid"></div>
</div>

<!-- Optimize -->
<div class="section" id="tab-optimize">
<div class="note-box">é›†ä¸­åˆ°é«˜ IV æ ‡çš„ï¼Œæœ€å¤§åŒ– Wheel æ”¶ç§Ÿæ•ˆç‡ã€‚çŸ­å‘¨æœŸ 5-7 DTE ä¼˜å…ˆã€‚</div>
<div class="sh"><h2>ğŸ”„ æ“ä½œè¿›åº¦</h2></div>
<div id="opt-changes" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>
<div class="sh"><h2>ğŸ“ˆ å½“å‰ vs ä¼˜åŒ–å</h2></div>
<div class="compare">
<div class="compare-box"><div class="sub">å½“å‰å¹´åŒ–æ”¶å…¥</div><div class="big yellow" id="cur-income">â€”</div><div class="sub" id="cur-yield">â€”</div></div>
<div class="compare-arrow">â†’</div>
<div class="compare-box"><div class="sub">ä¼˜åŒ–åå¹´åŒ–æ”¶å…¥</div><div class="big green" id="opt-income">â€”</div><div class="sub" id="opt-yield">â€”</div></div>
</div>
</div>
</div>

<script>
const ENC = {"salt":"zzxT+0jpYofmhEgh98CMdw==","iv":"55xcofhuU+ZL8/YO","tag":"XIXFEABYxzgsWtLWf3N5Tw==","data":"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"};

function b64(s){return Uint8Array.from(atob(s),c=>c.charCodeAt(0))}

async function decrypt(pwd){
  const enc=new TextEncoder();
  const km=await crypto.subtle.importKey('raw',enc.encode(pwd),{name:'PBKDF2'},false,['deriveKey']);
  const key=await crypto.subtle.deriveKey({name:'PBKDF2',salt:b64(ENC.salt),iterations:100000,hash:'SHA-256'},km,{name:'AES-GCM',length:256},false,['decrypt']);
  const ct=b64(ENC.data),tag=b64(ENC.tag);
  const combined=new Uint8Array(ct.length+tag.length);
  combined.set(ct);combined.set(tag,ct.length);
  return JSON.parse(new TextDecoder().decode(await crypto.subtle.decrypt({name:'AES-GCM',iv:b64(ENC.iv)},key,combined)));
}

document.getElementById('pwd').addEventListener('input',async function(){
  if(this.value.length===4){
    try{
      const data=await decrypt(this.value);
      document.getElementById('lock-screen').style.display='none';
      document.getElementById('dashboard').style.display='block';
      render(data);
    }catch(e){
      document.getElementById('pwd-error').textContent='å¯†ç é”™è¯¯';
      this.value='';
    }
  }
});

// Tab navigation
document.getElementById('nav').addEventListener('click',e=>{
  if(e.target.tagName!=='BUTTON')return;
  document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  e.target.classList.add('active');
  document.getElementById('tab-'+e.target.dataset.tab).classList.add('active');
});

const fmt=n=>'$'+n.toLocaleString('en-US',{minimumFractionDigits:0,maximumFractionDigits:0});
const fmtPct=n=>n.toFixed(1)+'%';
const days=(a,b)=>Math.round((new Date(b)-new Date(a))/864e5);

function dteTag(dte,total){
  const pct=Math.max(0,Math.min(100,(1-dte/total)*100));
  let color=dte<=3?'var(--red)':dte<=7?'var(--yellow)':'var(--green)';
  return `<div>${dte}å¤©</div><div class="dte-bar"><div class="dte-fill" style="width:${pct}%;background:${color}"></div></div>`;
}

function statusTag(text,type){return `<span class="tag tag-${type}">${text}</span>`}

function render(D){
  const today=D.updatedAt;
  document.getElementById('update-date').textContent=today;

  // === Summary ===
  let totalCCPremium=0,totalCSPPremium=0,totalRealized=0,totalCCCost=0,totalCSPCollateral=0,totalIdleCost=0;
  D.ccPositions.forEach(p=>{totalCCPremium+=p.premium;totalCCCost+=p.costPerShare*100});
  D.cspPositions.forEach(p=>{totalCSPPremium+=p.premium;totalCSPCollateral+=p.collateral});
  D.closedTrades.forEach(t=>totalRealized+=t.premium);
  D.idlePositions.forEach(p=>totalIdleCost+=p.shares*p.cost);

  const activePremium=totalCCPremium+totalCSPPremium;
  const totalCap=totalCCCost+totalCSPCollateral+totalIdleCost;
  const daysYTD=days('2026-01-01',today);
  const annRealized=daysYTD>0?totalRealized*(365/daysYTD):0;

  const cards=[
    {label:'æ´»è·ƒæƒåˆ©é‡‘',value:fmt(Math.round(activePremium)),cls:'green',sub:`CC ${fmt(Math.round(totalCCPremium))} + CSP ${fmt(Math.round(totalCSPPremium))}`},
    {label:'YTD å·²å®ç°',value:fmt(Math.round(totalRealized)),cls:'green',sub:`${D.closedTrades.length}ç¬” Â· å¹´åŒ–æ¨ç®— ${fmt(Math.round(annRealized))}`},
    {label:'æ´»è·ƒCC',value:D.ccPositions.length+'å¼ ',cls:'cyan',sub:fmt(Math.round(totalCCCost))+' è¦†ç›–'},
    {label:'æ´»è·ƒCSP',value:D.cspPositions.length+'å¼ ',cls:'purple',sub:fmt(Math.round(totalCSPCollateral))+' ä¿è¯é‡‘'},
    {label:'Wheel æ ‡çš„',value:D.wheelCycles.length+'ä¸ª',cls:'blue',sub:'CSP '+D.wheelCycles.filter(w=>w.phase==='csp').length+' Â· CC '+D.wheelCycles.filter(w=>w.phase.startsWith('cc')).length},
    {label:'é—²ç½®èµ„é‡‘',value:fmt(Math.round(totalIdleCost)),cls:'yellow',sub:D.idlePositions.length+'ä¸ªä»“ä½'}
  ];
  const sc=document.getElementById('summary-cards');
  cards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
    sc.appendChild(d);
  });

  // === Wheel Overview (on overview tab) ===
  renderWheelCards(D.wheelCycles,'wheel-overview');

  // === Wheel Tracker tab ===
  renderWheelCards(D.wheelCycles,'wheel-cards');

  // === CC Table ===
  document.getElementById('cc-count').textContent=D.ccPositions.length+'å¼ ';
  const ccTb=document.querySelector('#cc-table tbody');
  D.ccPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const cost100=p.costPerShare*100;
    const yPer=(p.premium/cost100)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='green'}
    else if(ann>15){st='æ­£å¸¸';sc2='green'}
    else{st='åä½';sc2='yellow'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(Math.round(cost100))}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    ccTb.appendChild(tr);
  });

  // === CSP Table ===
  document.getElementById('csp-count').textContent=D.cspPositions.length+'å¼ ';
  const cspTb=document.querySelector('#csp-table tbody');
  D.cspPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const yPer=(p.premium/p.collateral)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='purple'}
    else{st='æ­£å¸¸';sc2='green'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(p.collateral)}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    cspTb.appendChild(tr);
  });

  // === Closed Trades ===
  document.getElementById('closed-count').textContent=D.closedTrades.length+'ç¬”';
  const rCards=[
    {label:'YTD å·²å®ç°æ”¶ç›Š',value:fmt(Math.round(totalRealized)),cls:'green'},
    {label:'å·²å¹³ä»“ç¬”æ•°',value:D.closedTrades.length+'ç¬”',cls:'blue'},
    {label:'å¹´åŒ–æ¨ç®—',value:fmt(Math.round(annRealized)),cls:'green'}
  ];
  const rc=document.getElementById('realized-cards');
  rCards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>`;
    rc.appendChild(d);
  });
  const ctb=document.querySelector('#closed-table tbody');
  D.closedTrades.forEach(t=>{
    const d=days(t.openDate,t.closeDate);
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${t.ticker}</td><td>${statusTag(t.type,t.type==='CC'?'cyan':'purple')}</td><td>$${t.strike}</td><td>${t.openDate.slice(5)}</td><td>${t.closeDate.slice(5)}</td><td>${d}å¤©</td><td class="green">${fmt(t.premium)}</td><td>${statusTag(t.assigned?'è¢«Assign':'åˆ°æœŸå½’é›¶',t.assigned?'yellow':'green')}</td>`;
    ctb.appendChild(tr);
  });

  // === Idle ===
  const itb=document.querySelector('#idle-table tbody');
  D.idlePositions.forEach(p=>{
    const mv=p.shares*p.cost;
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>${p.shares}</td><td>$${p.cost}</td><td>${fmt(Math.round(mv))}</td><td>${p.canCC?statusTag('å¯ä»¥','green'):statusTag('ä¸è¶³100è‚¡','red')}</td><td style="color:var(--dim)">${p.note}</td>`;
    itb.appendChild(tr);
  });

  // === Decision Tab ===
  if(D.decision){
    const dec=D.decision;

    // Summary cards
    const dsc=document.getElementById('decision-summary');
    const ce=dec.capitalEfficiency||{};
    const dCards=[
      {label:'èµ„é‡‘åˆ©ç”¨ç‡',value:fmtPct(ce.utilization||0),cls:ce.utilization>60?'green':'yellow',sub:`éƒ¨ç½² ${fmt(ce.deployedCapital||0)} / æ€»è®¡ ${fmt(ce.totalCapital||0)}`},
      {label:'å¹´åŒ–æ”¶ç§Ÿæ”¶å…¥',value:fmt(ce.totalAnnualPremium||0),cls:'green',sub:`CC ${fmt(ce.ccAnnualPremium||0)} + CSP ${fmt(ce.cspAnnualPremium||0)}`},
      {label:'ç»„åˆå¹´åŒ–æ”¶ç›Šç‡',value:fmtPct(ce.totalYield||0),cls:ce.totalYield>20?'green':'yellow',sub:`å·¥ä½œèµ„é‡‘å¹´åŒ– ${fmtPct(ce.workingYield||0)}`},
      {label:'æ­»é’±å æ¯”',value:fmtPct(ce.deadMoneyPct||0),cls:ce.deadMoneyPct>10?'red':'green',sub:fmt(ce.deadMoney||0)+' é—²ç½®'},
      {label:'åˆ°æœŸæé†’',value:(dec.expiringAlerts||[]).length+'ä¸ª',cls:'yellow',sub:'æœ¬å‘¨éœ€å…³æ³¨'},
      {label:'CSP å€™é€‰',value:(dec.cspCandidates||[]).length+'ä¸ª',cls:'purple',sub:'ä¸‹å‘¨å¯å¼€ä»“'},
    ];
    dCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
      dsc.appendChild(d);
    });

    // Weekly plan
    const wp=document.getElementById('weekly-plan');
    const plans=dec.weeklyPlan||[];
    if(plans.length===0){
      wp.innerHTML='<div style="color:var(--dim);padding:8px">æš‚æ— æ“ä½œå»ºè®®</div>';
    }else{
      plans.forEach(p=>{
        const d=document.createElement('div');d.className='opt-item';
        const urgCls=p.urgency==='high'?'active':p.urgency==='medium'?'pending':'done';
        const urgLabel=p.urgency==='high'?'ç´§æ€¥':p.urgency==='medium'?'å…³æ³¨':'å»ºè®®';
        const catIcon={expiry:'â°',opportunity:'ğŸ¯',efficiency:'ğŸ’°',profit:'ğŸ¯',risk:'âš ï¸'}[p.category]||'ğŸ“‹';
        d.innerHTML=`<span class="opt-badge ${urgCls}">${urgLabel}</span><span>${catIcon} ${p.action}</span>${p.detail?'<div style="color:var(--dim);font-size:11px;margin-left:66px">â†’ '+p.detail+'</div>':''}`;
        wp.appendChild(d);
      });
    }

    // Profit tracking (80% take-profit)
    const pa=dec.profitAlerts||[];
    document.getElementById('profit-count').textContent=pa.length+'ä¸ª';
    const ptb=document.querySelector('#profit-table tbody');
    if(pa.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="8" style="color:var(--dim);text-align:center">æ— å®æ—¶æ•°æ®ï¼ˆéœ€ Futu OpenD åœ¨çº¿æ—¶é‡‡é›†ï¼‰</td>';
      ptb.appendChild(tr);
    }else{
      pa.forEach(a=>{
        const tr=document.createElement('tr');
        const pctCls=a.profitPct>=80?'green':a.profitPct>=0?'blue':'red';
        const sigTag=a.signal==='take_profit'?statusTag('ğŸ¯ æ­¢ç›ˆ','green'):a.signal==='approaching'?statusTag('æ¥è¿‘','blue'):a.signal==='underwater'?statusTag('æµ®äº','red'):statusTag('æŒæœ‰','dim');
        tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td class="green">${fmt(a.entryPremium)}</td><td>${fmt(a.currentValue)}</td><td class="${pctCls}"><strong>${a.profitPct>0?'+':''}${a.profitPct}%</strong></td><td>${sigTag}<div style="font-size:11px;color:var(--dim);margin-top:2px">${a.message}</div></td>`;
        ptb.appendChild(tr);
      });
    }

    // Expiring alerts
    const ea=dec.expiringAlerts||[];
    document.getElementById('expiry-count').textContent=ea.length+'ä¸ª';
    const etb=document.querySelector('#expiry-table tbody');
    ea.forEach(a=>{
      const tr=document.createElement('tr');
      const urgTag=a.urgency==='high'?statusTag('ç´§æ€¥','red'):statusTag('å…³æ³¨','yellow');
      tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td>${a.dte}å¤©</td><td class="green">${fmt(a.premium)}</td><td>${urgTag}</td><td style="color:var(--dim);font-size:12px">${a.action}</td><td style="font-size:12px">${a.nextStep||''}</td>`;
      etb.appendChild(tr);
    });

    // CSP candidates
    const cc2=dec.cspCandidates||[];
    document.getElementById('csp-cand-count').textContent=cc2.length+'ä¸ª';
    const cctb=document.querySelector('#csp-cand-table tbody');
    cc2.forEach((c,i)=>{
      const tr=document.createElement('tr');
      const signal=c.annYield>=200?'ğŸ”¥':c.annYield>=100?'ğŸ’°':'ğŸ‘€';
      const scoreColor=c.score>=100?'green':c.score>=50?'yellow':'dim';
      tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong> ${signal}</td><td>${c.oi.toLocaleString()}</td><td>${statusTag(c.score,scoreColor)}</td>`;
      cctb.appendChild(tr);
    });

    // CC candidates
    const ccCand=dec.ccCandidates||[];
    document.getElementById('cc-cand-count').textContent=ccCand.length+'ä¸ª';
    const ccCandTb=document.querySelector('#cc-cand-table tbody');
    if(ccCand.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="9" style="color:var(--dim);text-align:center">æ‰€æœ‰æŒä»“å·²æœ‰ CC è¦†ç›– âœ…</td>';
      ccCandTb.appendChild(tr);
    }else{
      ccCand.forEach(c=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong></td><td>${c.oi.toLocaleString()}</td>`;
        ccCandTb.appendChild(tr);
      });
    }

    // IV rankings (with change indicator)
    const ivg=document.getElementById('iv-ranking-grid');
    const ivr=dec.ivRankings||[];
    ivr.slice(0,8).forEach(r=>{
      const d=document.createElement('div');d.className='card';
      const cls=r.iv>=70?'red':r.iv>=50?'yellow':'dim';
      const signal=r.iv>=70?'ğŸ”¥':r.iv>=50?'ğŸ’°':'';
      const change=r.ivChange!=null?(r.ivChange>0?`<span class="red">+${r.ivChange}%</span>`:`<span class="green">${r.ivChange}%</span>`):'';
      d.innerHTML=`<div class="label">${r.ticker} ${signal}</div><div class="value ${cls}">${r.iv}%</div><div class="sub-value">$${r.price} ${change}</div>`;
      ivg.appendChild(d);
    });

    // Capital efficiency
    const ceg=document.getElementById('capital-eff-grid');
    const ceCards=[
      {label:'æ€»èµ„æœ¬',value:fmt(ce.totalCapital||0),cls:'blue'},
      {label:'å·²éƒ¨ç½²',value:fmt(ce.deployedCapital||0),cls:'green',sub:fmtPct(ce.utilization||0)+' åˆ©ç”¨ç‡'},
      {label:'é—²ç½®èµ„é‡‘',value:fmt(ce.deadMoney||0),cls:ce.deadMoneyPct>10?'red':'dim'},
      {label:'ç°é‡‘',value:fmt(ce.cash||0),cls:'blue'},
    ];
    ceCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>${c.sub?'<div class="sub-value">'+c.sub+'</div>':''}`;
      ceg.appendChild(d);
    });
  }else{
    // No decision data
    const dsc=document.getElementById('decision-summary');
    dsc.innerHTML='<div class="card" style="grid-column:1/-1"><div class="label">å†³ç­–æ•°æ®</div><div class="value yellow">æœªç”Ÿæˆ</div><div class="sub-value">è¿è¡Œ python decision_engine.py ç”Ÿæˆ</div></div>';
  }

  // === Optimize ===
  const oc=document.getElementById('opt-changes');
  D.optChanges.forEach(c=>{
    const d=document.createElement('div');d.className='opt-item';
    d.innerHTML=`<span class="opt-badge ${c.cls}">${c.action}</span><span>${c.detail}</span>`;
    oc.appendChild(d);
  });

  // Compare
  const ccAnnual=D.ccPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const cspAnnual=D.cspPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const curIncome=Math.round(ccAnnual+cspAnnual);
  const curYield=totalCap>0?(curIncome/totalCap*100):0;
  const optAI=D.optEstimates.reduce((s,e)=>s+e.monthlyPremium*12,0);
  const optTC=D.optEstimates.reduce((s,e)=>s+e.cost,0);
  document.getElementById('cur-income').textContent=fmt(curIncome);
  document.getElementById('cur-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(curYield);
  document.getElementById('opt-income').textContent=fmt(optAI);
  document.getElementById('opt-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(optTC>0?optAI/optTC*100:0);
}

function renderWheelCards(cycles,containerId){
  const container=document.getElementById(containerId);
  cycles.forEach(w=>{
    const d=document.createElement('div');
    d.className=`wheel-card phase-${w.phase}`;
    const phaseLabel={csp:'Sell Put',cc:'Sell Call','cc-exit':'æ¸…é€€ä¸­','cc-locked':'è¿œæœŸé”å®š'}[w.phase]||w.phase;
    const phaseTag={csp:'purple',cc:'green','cc-exit':'yellow','cc-locked':'red'}[w.phase]||'dim';
    d.innerHTML=`
      <div class="wc-header">
        <span class="wc-ticker">${w.ticker}</span>
        ${statusTag(phaseLabel,phaseTag)}
      </div>
      <div class="wc-detail">${w.detail}</div>
      <div class="wc-note" style="color:var(--dim)">${w.note}</div>
    `;
    container.appendChild(d);
  });
}
</script>
</body>
</html>
