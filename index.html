<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel Strategy Dashboard</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e14;--card:#12171f;--border:#1e2733;--text:#c9d1d9;--dim:#6e7681;--green:#3fb950;--red:#f85149;--blue:#58a6ff;--yellow:#d29922;--purple:#bc8cff;--cyan:#39d2c0;--green-bg:rgba(63,185,80,.1);--red-bg:rgba(248,81,73,.1);--blue-bg:rgba(88,166,255,.1);--yellow-bg:rgba(210,153,34,.1);--purple-bg:rgba(188,140,255,.1);--cyan-bg:rgba(57,210,192,.1)}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','Segoe UI',sans-serif;padding:20px;max-width:1200px;margin:0 auto;line-height:1.5}
#lock-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;height:80vh;animation:fadeIn .5s}
#lock-screen h1{font-size:56px;margin-bottom:24px}
#lock-screen input{background:var(--card);border:2px solid var(--border);border-radius:12px;color:var(--text);font-size:28px;padding:14px 24px;width:200px;text-align:center;letter-spacing:10px;outline:none;transition:border-color .2s}
#lock-screen input:focus{border-color:var(--blue)}
#lock-screen .error{color:var(--red);font-size:13px;margin-top:8px;height:20px}
#dashboard{display:none;animation:fadeIn .6s}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

/* Header */
.header{margin-bottom:28px}
.header h1{font-size:26px;font-weight:700;background:linear-gradient(135deg,var(--blue),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:inline}
.header .sub{color:var(--dim);font-size:13px;margin-top:4px}

/* Nav tabs */
.nav{display:flex;gap:4px;margin-bottom:24px;border-bottom:1px solid var(--border);padding-bottom:0;overflow-x:auto}
.nav button{background:none;border:none;color:var(--dim);font-size:13px;padding:10px 16px;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap}
.nav button:hover{color:var(--text)}
.nav button.active{color:var(--blue);border-bottom-color:var(--blue)}

/* Sections */
.section{display:none}.section.active{display:block;animation:fadeIn .3s}

/* Summary grid */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-bottom:24px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;transition:transform .15s,border-color .15s}
.card:hover{transform:translateY(-2px);border-color:rgba(88,166,255,.3)}
.card .label{color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.card .value{font-size:22px;font-weight:700}
.card .sub-value{font-size:11px;color:var(--dim);margin-top:2px}
.green{color:var(--green)}.red{color:var(--red)}.blue{color:var(--blue)}.yellow{color:var(--yellow)}.purple{color:var(--purple)}.cyan{color:var(--cyan)}

/* Tables */
table{width:100%;border-collapse:collapse;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:16px;font-size:13px}
th{background:rgba(30,39,51,.8);color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;padding:10px 14px;text-align:left;font-weight:600}
td{padding:10px 14px;border-top:1px solid var(--border)}
tr:hover{background:rgba(88,166,255,.03)}
.ticker{font-weight:700;color:var(--text)}

/* Tags */
.tag{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600}
.tag-green{background:var(--green-bg);color:var(--green)}
.tag-red{background:var(--red-bg);color:var(--red)}
.tag-blue{background:var(--blue-bg);color:var(--blue)}
.tag-yellow{background:var(--yellow-bg);color:var(--yellow)}
.tag-purple{background:var(--purple-bg);color:var(--purple)}
.tag-cyan{background:var(--cyan-bg);color:var(--cyan)}
.tag-dim{background:rgba(110,118,129,.1);color:var(--dim)}

/* DTE bar */
.dte-bar{width:100%;height:4px;background:var(--border);border-radius:2px;overflow:hidden;margin-top:4px}
.dte-fill{height:100%;border-radius:2px;transition:width .3s}

/* Wheel tracker */
.wheel-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-bottom:24px}
.wheel-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;position:relative;overflow:hidden}
.wheel-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.wheel-card.phase-csp::before{background:linear-gradient(90deg,var(--purple),var(--blue))}
.wheel-card.phase-cc::before{background:linear-gradient(90deg,var(--green),var(--cyan))}
.wheel-card.phase-cc-exit::before{background:linear-gradient(90deg,var(--yellow),var(--red))}
.wheel-card.phase-cc-locked::before{background:linear-gradient(90deg,var(--red),var(--yellow))}
.wheel-card .wc-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.wheel-card .wc-ticker{font-size:18px;font-weight:700}
.wheel-card .wc-detail{color:var(--dim);font-size:12px}
.wheel-card .wc-note{font-size:12px;margin-top:4px}

/* Phase flow */
.phase-flow{display:flex;align-items:center;gap:6px;margin:20px 0}
.phase-step{padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;opacity:.3}
.phase-step.active{opacity:1}
.phase-step.step-csp{background:var(--purple-bg);color:var(--purple)}
.phase-step.step-assign{background:var(--yellow-bg);color:var(--yellow)}
.phase-step.step-cc{background:var(--green-bg);color:var(--green)}
.phase-arrow{color:var(--dim);font-size:10px;opacity:.4}

/* Section headers */
.sh{display:flex;align-items:center;gap:10px;margin:28px 0 14px;padding-bottom:10px;border-bottom:1px solid var(--border)}
.sh h2{font-size:15px;font-weight:600;color:var(--text)}
.sh .count{font-size:12px;color:var(--dim);background:var(--border);padding:2px 8px;border-radius:10px}

/* Opt changes */
.opt-item{display:flex;align-items:center;gap:10px;padding:8px 0;font-size:13px;border-bottom:1px solid var(--border)}
.opt-item:last-child{border-bottom:none}
.opt-badge{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;min-width:56px;text-align:center}
.opt-badge.done{background:var(--green-bg);color:var(--green)}
.opt-badge.active{background:var(--blue-bg);color:var(--blue)}
.opt-badge.pending{background:var(--yellow-bg);color:var(--yellow)}

/* Compare */
.compare{display:grid;grid-template-columns:1fr 50px 1fr;gap:0;margin:20px 0}
.compare-box{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:24px;text-align:center}
.compare-arrow{display:flex;align-items:center;justify-content:center;font-size:24px;color:var(--blue)}
.compare-box .big{font-size:30px;font-weight:700;margin:8px 0}
.compare-box .sub{color:var(--dim);font-size:12px}

/* Note */
.note-box{background:var(--card);border-left:3px solid var(--yellow);padding:12px 16px;margin:16px 0;font-size:13px;color:var(--yellow);border-radius:0 12px 12px 0}

/* Responsive */
@media(max-width:640px){
  body{padding:12px}
  .grid{grid-template-columns:repeat(2,1fr);gap:8px}
  .card .value{font-size:18px}
  .wheel-grid{grid-template-columns:1fr}
  table{font-size:12px}
  th,td{padding:8px 10px}
  .compare{grid-template-columns:1fr;gap:8px}
  .compare-arrow{transform:rotate(90deg)}
}
</style>
</head>
<body>

<div id="lock-screen">
<h1>ğŸ”’</h1>
<input type="password" id="pwd" maxlength="4" placeholder="Â·Â·Â·Â·" autofocus>
<div class="error" id="pwd-error"></div>
</div>

<div id="dashboard">
<div class="header">
<h1>ğŸ´ Wheel Strategy Dashboard</h1>
<p class="sub">Theta Gang æ”¶ç§Ÿè¿½è¸ª Â· <span id="update-date">â€”</span></p>
</div>

<div class="nav" id="nav">
<button class="active" data-tab="overview">æ€»è§ˆ</button>
<button data-tab="wheel">Wheel è¿½è¸ª</button>
<button data-tab="cc">Covered Calls</button>
<button data-tab="csp">Cash-Secured Puts</button>
<button data-tab="closed">å·²å®ç°æ”¶ç›Š</button>
<button data-tab="idle">é—²ç½®ä»“ä½</button>
<button data-tab="decision">ğŸ¯ å†³ç­–</button>
<button data-tab="optimize">ä¼˜åŒ–æ–¹æ¡ˆ</button>
</div>

<!-- Overview -->
<div class="section active" id="tab-overview">
<div class="grid" id="summary-cards"></div>
<div class="sh"><h2>ğŸ”„ Wheel çŠ¶æ€ä¸€è§ˆ</h2></div>
<div class="wheel-grid" id="wheel-overview"></div>
</div>

<!-- Wheel Tracker -->
<div class="section" id="tab-wheel">
<div class="phase-flow">
<div class="phase-step step-csp">Sell Put</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign æ¥è‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-cc">Sell Call</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign å‡ºè‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-csp">Sell Put â™»ï¸</div>
</div>
<div class="wheel-grid" id="wheel-cards"></div>
</div>

<!-- CC -->
<div class="section" id="tab-cc">
<div class="sh"><h2>ğŸ“Š Covered Call æŒä»“</h2><span class="count" id="cc-count">0</span></div>
<table id="cc-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>æˆæœ¬</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- CSP -->
<div class="section" id="tab-csp">
<div class="sh"><h2>ğŸ’ Cash-Secured Put æŒä»“</h2><span class="count" id="csp-count">0</span></div>
<table id="csp-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>ä¿è¯é‡‘</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Closed -->
<div class="section" id="tab-closed">
<div class="grid" id="realized-cards"></div>
<div class="sh"><h2>ğŸ’° å·²å¹³ä»“è®°å½•</h2><span class="count" id="closed-count">0</span></div>
<table id="closed-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>å¼€ä»“</th><th>å¹³ä»“</th><th>å¤©æ•°</th><th>æƒåˆ©é‡‘</th><th>ç»“æœ</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Idle -->
<div class="section" id="tab-idle">
<div class="sh"><h2>ğŸ’¤ æœªå¼€ä»“ä½ï¼ˆé—²ç½®èµ„é‡‘ï¼‰</h2></div>
<table id="idle-table"><thead><tr>
<th>æ ‡çš„</th><th>è‚¡æ•°</th><th>å‡ä»·</th><th>å¸‚å€¼</th><th>å¯å¼€CC</th><th>å¤‡æ³¨</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Decision -->
<div class="section" id="tab-decision">
<div class="grid" id="decision-summary"></div>

<div class="sh"><h2>âš¡ æœ¬å‘¨æ“ä½œå»ºè®®</h2></div>
<div id="weekly-plan" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>

<div class="sh"><h2>ğŸ“Š 80% æ­¢ç›ˆè¿½è¸ª</h2><span class="count" id="profit-count">0</span></div>
<table id="profit-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>å¼€ä»“æƒåˆ©é‡‘</th><th>å½“å‰ä»·å€¼</th><th>ç›ˆåˆ©%</th><th>ä¿¡å·</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>â° åˆ°æœŸæé†’</h2><span class="count" id="expiry-count">0</span></div>
<table id="expiry-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>çŠ¶æ€</th><th>å»ºè®®</th><th>ä¸‹ä¸€æ­¥</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ¯ ä¸‹å‘¨æœ€ä¼˜ CSP å€™é€‰</h2><span class="count" id="csp-cand-count">0</span></div>
<table id="csp-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th><th>è¯„åˆ†</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“ˆ CC å¼€ä»“å€™é€‰ï¼ˆæœªè¦†ç›–æŒä»“ï¼‰</h2><span class="count" id="cc-cand-count">0</span></div>
<table id="cc-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“Š IV æ’è¡Œ</h2></div>
<div class="grid" id="iv-ranking-grid"></div>

<div class="sh"><h2>ğŸ’° èµ„é‡‘æ•ˆç‡</h2></div>
<div class="grid" id="capital-eff-grid"></div>
</div>

<!-- Optimize -->
<div class="section" id="tab-optimize">
<div class="note-box">é›†ä¸­åˆ°é«˜ IV æ ‡çš„ï¼Œæœ€å¤§åŒ– Wheel æ”¶ç§Ÿæ•ˆç‡ã€‚çŸ­å‘¨æœŸ 5-7 DTE ä¼˜å…ˆã€‚</div>
<div class="sh"><h2>ğŸ”„ æ“ä½œè¿›åº¦</h2></div>
<div id="opt-changes" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>
<div class="sh"><h2>ğŸ“ˆ å½“å‰ vs ä¼˜åŒ–å</h2></div>
<div class="compare">
<div class="compare-box"><div class="sub">å½“å‰å¹´åŒ–æ”¶å…¥</div><div class="big yellow" id="cur-income">â€”</div><div class="sub" id="cur-yield">â€”</div></div>
<div class="compare-arrow">â†’</div>
<div class="compare-box"><div class="sub">ä¼˜åŒ–åå¹´åŒ–æ”¶å…¥</div><div class="big green" id="opt-income">â€”</div><div class="sub" id="opt-yield">â€”</div></div>
</div>
</div>
</div>

<script>
const ENC = {"salt":"fndHTaa2zNtwKxwOjN0bvg==","iv":"q7fAFQTO2IorlDGn","tag":"4eyzOQU90754pgIMt+i2mg==","data":"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"};

function b64(s){return Uint8Array.from(atob(s),c=>c.charCodeAt(0))}

async function decrypt(pwd){
  const enc=new TextEncoder();
  const km=await crypto.subtle.importKey('raw',enc.encode(pwd),{name:'PBKDF2'},false,['deriveKey']);
  const key=await crypto.subtle.deriveKey({name:'PBKDF2',salt:b64(ENC.salt),iterations:100000,hash:'SHA-256'},km,{name:'AES-GCM',length:256},false,['decrypt']);
  const ct=b64(ENC.data),tag=b64(ENC.tag);
  const combined=new Uint8Array(ct.length+tag.length);
  combined.set(ct);combined.set(tag,ct.length);
  return JSON.parse(new TextDecoder().decode(await crypto.subtle.decrypt({name:'AES-GCM',iv:b64(ENC.iv)},key,combined)));
}

document.getElementById('pwd').addEventListener('input',async function(){
  if(this.value.length===4){
    try{
      const data=await decrypt(this.value);
      document.getElementById('lock-screen').style.display='none';
      document.getElementById('dashboard').style.display='block';
      render(data);
    }catch(e){
      document.getElementById('pwd-error').textContent='å¯†ç é”™è¯¯';
      this.value='';
    }
  }
});

// Tab navigation
document.getElementById('nav').addEventListener('click',e=>{
  if(e.target.tagName!=='BUTTON')return;
  document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  e.target.classList.add('active');
  document.getElementById('tab-'+e.target.dataset.tab).classList.add('active');
});

const fmt=n=>'$'+n.toLocaleString('en-US',{minimumFractionDigits:0,maximumFractionDigits:0});
const fmtPct=n=>n.toFixed(1)+'%';
const days=(a,b)=>Math.round((new Date(b)-new Date(a))/864e5);

function dteTag(dte,total){
  const pct=Math.max(0,Math.min(100,(1-dte/total)*100));
  let color=dte<=3?'var(--red)':dte<=7?'var(--yellow)':'var(--green)';
  return `<div>${dte}å¤©</div><div class="dte-bar"><div class="dte-fill" style="width:${pct}%;background:${color}"></div></div>`;
}

function statusTag(text,type){return `<span class="tag tag-${type}">${text}</span>`}

function render(D){
  const today=D.updatedAt;
  document.getElementById('update-date').textContent=today;

  // === Summary ===
  let totalCCPremium=0,totalCSPPremium=0,totalRealized=0,totalCCCost=0,totalCSPCollateral=0,totalIdleCost=0;
  D.ccPositions.forEach(p=>{totalCCPremium+=p.premium;totalCCCost+=p.costPerShare*100});
  D.cspPositions.forEach(p=>{totalCSPPremium+=p.premium;totalCSPCollateral+=p.collateral});
  D.closedTrades.forEach(t=>totalRealized+=t.premium);
  D.idlePositions.forEach(p=>totalIdleCost+=p.shares*p.cost);

  const activePremium=totalCCPremium+totalCSPPremium;
  const totalCap=totalCCCost+totalCSPCollateral+totalIdleCost;
  const daysYTD=days('2026-01-01',today);
  const annRealized=daysYTD>0?totalRealized*(365/daysYTD):0;

  const cards=[
    {label:'æ´»è·ƒæƒåˆ©é‡‘',value:fmt(Math.round(activePremium)),cls:'green',sub:`CC ${fmt(Math.round(totalCCPremium))} + CSP ${fmt(Math.round(totalCSPPremium))}`},
    {label:'YTD å·²å®ç°',value:fmt(Math.round(totalRealized)),cls:'green',sub:`${D.closedTrades.length}ç¬” Â· å¹´åŒ–æ¨ç®— ${fmt(Math.round(annRealized))}`},
    {label:'æ´»è·ƒCC',value:D.ccPositions.length+'å¼ ',cls:'cyan',sub:fmt(Math.round(totalCCCost))+' è¦†ç›–'},
    {label:'æ´»è·ƒCSP',value:D.cspPositions.length+'å¼ ',cls:'purple',sub:fmt(Math.round(totalCSPCollateral))+' ä¿è¯é‡‘'},
    {label:'Wheel æ ‡çš„',value:D.wheelCycles.length+'ä¸ª',cls:'blue',sub:'CSP '+D.wheelCycles.filter(w=>w.phase==='csp').length+' Â· CC '+D.wheelCycles.filter(w=>w.phase.startsWith('cc')).length},
    {label:'é—²ç½®èµ„é‡‘',value:fmt(Math.round(totalIdleCost)),cls:'yellow',sub:D.idlePositions.length+'ä¸ªä»“ä½'}
  ];
  const sc=document.getElementById('summary-cards');
  cards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
    sc.appendChild(d);
  });

  // === Wheel Overview (on overview tab) ===
  renderWheelCards(D.wheelCycles,'wheel-overview');

  // === Wheel Tracker tab ===
  renderWheelCards(D.wheelCycles,'wheel-cards');

  // === CC Table ===
  document.getElementById('cc-count').textContent=D.ccPositions.length+'å¼ ';
  const ccTb=document.querySelector('#cc-table tbody');
  D.ccPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const cost100=p.costPerShare*100;
    const yPer=(p.premium/cost100)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='green'}
    else if(ann>15){st='æ­£å¸¸';sc2='green'}
    else{st='åä½';sc2='yellow'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(Math.round(cost100))}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    ccTb.appendChild(tr);
  });

  // === CSP Table ===
  document.getElementById('csp-count').textContent=D.cspPositions.length+'å¼ ';
  const cspTb=document.querySelector('#csp-table tbody');
  D.cspPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const yPer=(p.premium/p.collateral)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='purple'}
    else{st='æ­£å¸¸';sc2='green'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(p.collateral)}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    cspTb.appendChild(tr);
  });

  // === Closed Trades ===
  document.getElementById('closed-count').textContent=D.closedTrades.length+'ç¬”';
  const rCards=[
    {label:'YTD å·²å®ç°æ”¶ç›Š',value:fmt(Math.round(totalRealized)),cls:'green'},
    {label:'å·²å¹³ä»“ç¬”æ•°',value:D.closedTrades.length+'ç¬”',cls:'blue'},
    {label:'å¹´åŒ–æ¨ç®—',value:fmt(Math.round(annRealized)),cls:'green'}
  ];
  const rc=document.getElementById('realized-cards');
  rCards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>`;
    rc.appendChild(d);
  });
  const ctb=document.querySelector('#closed-table tbody');
  D.closedTrades.forEach(t=>{
    const d=days(t.openDate,t.closeDate);
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${t.ticker}</td><td>${statusTag(t.type,t.type==='CC'?'cyan':'purple')}</td><td>$${t.strike}</td><td>${t.openDate.slice(5)}</td><td>${t.closeDate.slice(5)}</td><td>${d}å¤©</td><td class="green">${fmt(t.premium)}</td><td>${statusTag(t.assigned?'è¢«Assign':'åˆ°æœŸå½’é›¶',t.assigned?'yellow':'green')}</td>`;
    ctb.appendChild(tr);
  });

  // === Idle ===
  const itb=document.querySelector('#idle-table tbody');
  D.idlePositions.forEach(p=>{
    const mv=p.shares*p.cost;
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>${p.shares}</td><td>$${p.cost}</td><td>${fmt(Math.round(mv))}</td><td>${p.canCC?statusTag('å¯ä»¥','green'):statusTag('ä¸è¶³100è‚¡','red')}</td><td style="color:var(--dim)">${p.note}</td>`;
    itb.appendChild(tr);
  });

  // === Decision Tab ===
  if(D.decision){
    const dec=D.decision;

    // Summary cards
    const dsc=document.getElementById('decision-summary');
    const ce=dec.capitalEfficiency||{};
    const dCards=[
      {label:'èµ„é‡‘åˆ©ç”¨ç‡',value:fmtPct(ce.utilization||0),cls:ce.utilization>60?'green':'yellow',sub:`éƒ¨ç½² ${fmt(ce.deployedCapital||0)} / æ€»è®¡ ${fmt(ce.totalCapital||0)}`},
      {label:'å¹´åŒ–æ”¶ç§Ÿæ”¶å…¥',value:fmt(ce.totalAnnualPremium||0),cls:'green',sub:`CC ${fmt(ce.ccAnnualPremium||0)} + CSP ${fmt(ce.cspAnnualPremium||0)}`},
      {label:'ç»„åˆå¹´åŒ–æ”¶ç›Šç‡',value:fmtPct(ce.totalYield||0),cls:ce.totalYield>20?'green':'yellow',sub:`å·¥ä½œèµ„é‡‘å¹´åŒ– ${fmtPct(ce.workingYield||0)}`},
      {label:'æ­»é’±å æ¯”',value:fmtPct(ce.deadMoneyPct||0),cls:ce.deadMoneyPct>10?'red':'green',sub:fmt(ce.deadMoney||0)+' é—²ç½®'},
      {label:'åˆ°æœŸæé†’',value:(dec.expiringAlerts||[]).length+'ä¸ª',cls:'yellow',sub:'æœ¬å‘¨éœ€å…³æ³¨'},
      {label:'CSP å€™é€‰',value:(dec.cspCandidates||[]).length+'ä¸ª',cls:'purple',sub:'ä¸‹å‘¨å¯å¼€ä»“'},
    ];
    dCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
      dsc.appendChild(d);
    });

    // Weekly plan
    const wp=document.getElementById('weekly-plan');
    const plans=dec.weeklyPlan||[];
    if(plans.length===0){
      wp.innerHTML='<div style="color:var(--dim);padding:8px">æš‚æ— æ“ä½œå»ºè®®</div>';
    }else{
      plans.forEach(p=>{
        const d=document.createElement('div');d.className='opt-item';
        const urgCls=p.urgency==='high'?'active':p.urgency==='medium'?'pending':'done';
        const urgLabel=p.urgency==='high'?'ç´§æ€¥':p.urgency==='medium'?'å…³æ³¨':'å»ºè®®';
        const catIcon={expiry:'â°',opportunity:'ğŸ¯',efficiency:'ğŸ’°',profit:'ğŸ¯',risk:'âš ï¸'}[p.category]||'ğŸ“‹';
        d.innerHTML=`<span class="opt-badge ${urgCls}">${urgLabel}</span><span>${catIcon} ${p.action}</span>${p.detail?'<div style="color:var(--dim);font-size:11px;margin-left:66px">â†’ '+p.detail+'</div>':''}`;
        wp.appendChild(d);
      });
    }

    // Profit tracking (80% take-profit)
    const pa=dec.profitAlerts||[];
    document.getElementById('profit-count').textContent=pa.length+'ä¸ª';
    const ptb=document.querySelector('#profit-table tbody');
    if(pa.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="8" style="color:var(--dim);text-align:center">æ— å®æ—¶æ•°æ®ï¼ˆéœ€ Futu OpenD åœ¨çº¿æ—¶é‡‡é›†ï¼‰</td>';
      ptb.appendChild(tr);
    }else{
      pa.forEach(a=>{
        const tr=document.createElement('tr');
        const pctCls=a.profitPct>=80?'green':a.profitPct>=0?'blue':'red';
        const sigTag=a.signal==='take_profit'?statusTag('ğŸ¯ æ­¢ç›ˆ','green'):a.signal==='approaching'?statusTag('æ¥è¿‘','blue'):a.signal==='underwater'?statusTag('æµ®äº','red'):statusTag('æŒæœ‰','dim');
        tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td class="green">${fmt(a.entryPremium)}</td><td>${fmt(a.currentValue)}</td><td class="${pctCls}"><strong>${a.profitPct>0?'+':''}${a.profitPct}%</strong></td><td>${sigTag}<div style="font-size:11px;color:var(--dim);margin-top:2px">${a.message}</div></td>`;
        ptb.appendChild(tr);
      });
    }

    // Expiring alerts
    const ea=dec.expiringAlerts||[];
    document.getElementById('expiry-count').textContent=ea.length+'ä¸ª';
    const etb=document.querySelector('#expiry-table tbody');
    ea.forEach(a=>{
      const tr=document.createElement('tr');
      const urgTag=a.urgency==='high'?statusTag('ç´§æ€¥','red'):statusTag('å…³æ³¨','yellow');
      tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td>${a.dte}å¤©</td><td class="green">${fmt(a.premium)}</td><td>${urgTag}</td><td style="color:var(--dim);font-size:12px">${a.action}</td><td style="font-size:12px">${a.nextStep||''}</td>`;
      etb.appendChild(tr);
    });

    // CSP candidates
    const cc2=dec.cspCandidates||[];
    document.getElementById('csp-cand-count').textContent=cc2.length+'ä¸ª';
    const cctb=document.querySelector('#csp-cand-table tbody');
    cc2.forEach((c,i)=>{
      const tr=document.createElement('tr');
      const signal=c.annYield>=200?'ğŸ”¥':c.annYield>=100?'ğŸ’°':'ğŸ‘€';
      const scoreColor=c.score>=100?'green':c.score>=50?'yellow':'dim';
      tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong> ${signal}</td><td>${c.oi.toLocaleString()}</td><td>${statusTag(c.score,scoreColor)}</td>`;
      cctb.appendChild(tr);
    });

    // CC candidates
    const ccCand=dec.ccCandidates||[];
    document.getElementById('cc-cand-count').textContent=ccCand.length+'ä¸ª';
    const ccCandTb=document.querySelector('#cc-cand-table tbody');
    if(ccCand.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="9" style="color:var(--dim);text-align:center">æ‰€æœ‰æŒä»“å·²æœ‰ CC è¦†ç›– âœ…</td>';
      ccCandTb.appendChild(tr);
    }else{
      ccCand.forEach(c=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong></td><td>${c.oi.toLocaleString()}</td>`;
        ccCandTb.appendChild(tr);
      });
    }

    // IV rankings (with change indicator)
    const ivg=document.getElementById('iv-ranking-grid');
    const ivr=dec.ivRankings||[];
    ivr.slice(0,8).forEach(r=>{
      const d=document.createElement('div');d.className='card';
      const cls=r.iv>=70?'red':r.iv>=50?'yellow':'dim';
      const signal=r.iv>=70?'ğŸ”¥':r.iv>=50?'ğŸ’°':'';
      const change=r.ivChange!=null?(r.ivChange>0?`<span class="red">+${r.ivChange}%</span>`:`<span class="green">${r.ivChange}%</span>`):'';
      d.innerHTML=`<div class="label">${r.ticker} ${signal}</div><div class="value ${cls}">${r.iv}%</div><div class="sub-value">$${r.price} ${change}</div>`;
      ivg.appendChild(d);
    });

    // Capital efficiency
    const ceg=document.getElementById('capital-eff-grid');
    const ceCards=[
      {label:'æ€»èµ„æœ¬',value:fmt(ce.totalCapital||0),cls:'blue'},
      {label:'å·²éƒ¨ç½²',value:fmt(ce.deployedCapital||0),cls:'green',sub:fmtPct(ce.utilization||0)+' åˆ©ç”¨ç‡'},
      {label:'é—²ç½®èµ„é‡‘',value:fmt(ce.deadMoney||0),cls:ce.deadMoneyPct>10?'red':'dim'},
      {label:'ç°é‡‘',value:fmt(ce.cash||0),cls:'blue'},
    ];
    ceCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>${c.sub?'<div class="sub-value">'+c.sub+'</div>':''}`;
      ceg.appendChild(d);
    });
  }else{
    // No decision data
    const dsc=document.getElementById('decision-summary');
    dsc.innerHTML='<div class="card" style="grid-column:1/-1"><div class="label">å†³ç­–æ•°æ®</div><div class="value yellow">æœªç”Ÿæˆ</div><div class="sub-value">è¿è¡Œ python decision_engine.py ç”Ÿæˆ</div></div>';
  }

  // === Optimize ===
  const oc=document.getElementById('opt-changes');
  D.optChanges.forEach(c=>{
    const d=document.createElement('div');d.className='opt-item';
    d.innerHTML=`<span class="opt-badge ${c.cls}">${c.action}</span><span>${c.detail}</span>`;
    oc.appendChild(d);
  });

  // Compare
  const ccAnnual=D.ccPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const cspAnnual=D.cspPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const curIncome=Math.round(ccAnnual+cspAnnual);
  const curYield=totalCap>0?(curIncome/totalCap*100):0;
  const optAI=D.optEstimates.reduce((s,e)=>s+e.monthlyPremium*12,0);
  const optTC=D.optEstimates.reduce((s,e)=>s+e.cost,0);
  document.getElementById('cur-income').textContent=fmt(curIncome);
  document.getElementById('cur-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(curYield);
  document.getElementById('opt-income').textContent=fmt(optAI);
  document.getElementById('opt-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(optTC>0?optAI/optTC*100:0);
}

function renderWheelCards(cycles,containerId){
  const container=document.getElementById(containerId);
  cycles.forEach(w=>{
    const d=document.createElement('div');
    d.className=`wheel-card phase-${w.phase}`;
    const phaseLabel={csp:'Sell Put',cc:'Sell Call','cc-exit':'æ¸…é€€ä¸­','cc-locked':'è¿œæœŸé”å®š'}[w.phase]||w.phase;
    const phaseTag={csp:'purple',cc:'green','cc-exit':'yellow','cc-locked':'red'}[w.phase]||'dim';
    d.innerHTML=`
      <div class="wc-header">
        <span class="wc-ticker">${w.ticker}</span>
        ${statusTag(phaseLabel,phaseTag)}
      </div>
      <div class="wc-detail">${w.detail}</div>
      <div class="wc-note" style="color:var(--dim)">${w.note}</div>
    `;
    container.appendChild(d);
  });
}
</script>
</body>
</html>
