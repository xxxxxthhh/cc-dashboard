<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel Strategy Dashboard</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e14;--card:#12171f;--border:#1e2733;--text:#c9d1d9;--dim:#6e7681;--green:#3fb950;--red:#f85149;--blue:#58a6ff;--yellow:#d29922;--purple:#bc8cff;--cyan:#39d2c0;--green-bg:rgba(63,185,80,.1);--red-bg:rgba(248,81,73,.1);--blue-bg:rgba(88,166,255,.1);--yellow-bg:rgba(210,153,34,.1);--purple-bg:rgba(188,140,255,.1);--cyan-bg:rgba(57,210,192,.1)}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','Segoe UI',sans-serif;padding:20px;max-width:1200px;margin:0 auto;line-height:1.5}
#lock-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;height:80vh;animation:fadeIn .5s}
#lock-screen h1{font-size:56px;margin-bottom:24px}
#lock-screen input{background:var(--card);border:2px solid var(--border);border-radius:12px;color:var(--text);font-size:28px;padding:14px 24px;width:200px;text-align:center;letter-spacing:10px;outline:none;transition:border-color .2s}
#lock-screen input:focus{border-color:var(--blue)}
#lock-screen .error{color:var(--red);font-size:13px;margin-top:8px;height:20px}
#dashboard{display:none;animation:fadeIn .6s}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

/* Header */
.header{margin-bottom:28px}
.header h1{font-size:26px;font-weight:700;background:linear-gradient(135deg,var(--blue),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:inline}
.header .sub{color:var(--dim);font-size:13px;margin-top:4px}

/* Nav tabs */
.nav{display:flex;gap:4px;margin-bottom:24px;border-bottom:1px solid var(--border);padding-bottom:0;overflow-x:auto}
.nav button{background:none;border:none;color:var(--dim);font-size:13px;padding:10px 16px;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap}
.nav button:hover{color:var(--text)}
.nav button.active{color:var(--blue);border-bottom-color:var(--blue)}

/* Sections */
.section{display:none}.section.active{display:block;animation:fadeIn .3s}

/* Summary grid */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-bottom:24px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;transition:transform .15s,border-color .15s}
.card:hover{transform:translateY(-2px);border-color:rgba(88,166,255,.3)}
.card .label{color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.card .value{font-size:22px;font-weight:700}
.card .sub-value{font-size:11px;color:var(--dim);margin-top:2px}
.green{color:var(--green)}.red{color:var(--red)}.blue{color:var(--blue)}.yellow{color:var(--yellow)}.purple{color:var(--purple)}.cyan{color:var(--cyan)}

/* Tables */
table{width:100%;border-collapse:collapse;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:16px;font-size:13px}
th{background:rgba(30,39,51,.8);color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;padding:10px 14px;text-align:left;font-weight:600}
td{padding:10px 14px;border-top:1px solid var(--border)}
tr:hover{background:rgba(88,166,255,.03)}
.ticker{font-weight:700;color:var(--text)}

/* Tags */
.tag{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600}
.tag-green{background:var(--green-bg);color:var(--green)}
.tag-red{background:var(--red-bg);color:var(--red)}
.tag-blue{background:var(--blue-bg);color:var(--blue)}
.tag-yellow{background:var(--yellow-bg);color:var(--yellow)}
.tag-purple{background:var(--purple-bg);color:var(--purple)}
.tag-cyan{background:var(--cyan-bg);color:var(--cyan)}
.tag-dim{background:rgba(110,118,129,.1);color:var(--dim)}

/* DTE bar */
.dte-bar{width:100%;height:4px;background:var(--border);border-radius:2px;overflow:hidden;margin-top:4px}
.dte-fill{height:100%;border-radius:2px;transition:width .3s}

/* Wheel tracker */
.wheel-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-bottom:24px}
.wheel-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;position:relative;overflow:hidden}
.wheel-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.wheel-card.phase-csp::before{background:linear-gradient(90deg,var(--purple),var(--blue))}
.wheel-card.phase-cc::before{background:linear-gradient(90deg,var(--green),var(--cyan))}
.wheel-card.phase-cc-exit::before{background:linear-gradient(90deg,var(--yellow),var(--red))}
.wheel-card.phase-cc-locked::before{background:linear-gradient(90deg,var(--red),var(--yellow))}
.wheel-card .wc-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.wheel-card .wc-ticker{font-size:18px;font-weight:700}
.wheel-card .wc-detail{color:var(--dim);font-size:12px}
.wheel-card .wc-note{font-size:12px;margin-top:4px}

/* Phase flow */
.phase-flow{display:flex;align-items:center;gap:6px;margin:20px 0}
.phase-step{padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;opacity:.3}
.phase-step.active{opacity:1}
.phase-step.step-csp{background:var(--purple-bg);color:var(--purple)}
.phase-step.step-assign{background:var(--yellow-bg);color:var(--yellow)}
.phase-step.step-cc{background:var(--green-bg);color:var(--green)}
.phase-arrow{color:var(--dim);font-size:10px;opacity:.4}

/* Section headers */
.sh{display:flex;align-items:center;gap:10px;margin:28px 0 14px;padding-bottom:10px;border-bottom:1px solid var(--border)}
.sh h2{font-size:15px;font-weight:600;color:var(--text)}
.sh .count{font-size:12px;color:var(--dim);background:var(--border);padding:2px 8px;border-radius:10px}

/* Opt changes */
.opt-item{display:flex;align-items:center;gap:10px;padding:8px 0;font-size:13px;border-bottom:1px solid var(--border)}
.opt-item:last-child{border-bottom:none}
.opt-badge{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;min-width:56px;text-align:center}
.opt-badge.done{background:var(--green-bg);color:var(--green)}
.opt-badge.active{background:var(--blue-bg);color:var(--blue)}
.opt-badge.pending{background:var(--yellow-bg);color:var(--yellow)}

/* Compare */
.compare{display:grid;grid-template-columns:1fr 50px 1fr;gap:0;margin:20px 0}
.compare-box{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:24px;text-align:center}
.compare-arrow{display:flex;align-items:center;justify-content:center;font-size:24px;color:var(--blue)}
.compare-box .big{font-size:30px;font-weight:700;margin:8px 0}
.compare-box .sub{color:var(--dim);font-size:12px}

/* Note */
.note-box{background:var(--card);border-left:3px solid var(--yellow);padding:12px 16px;margin:16px 0;font-size:13px;color:var(--yellow);border-radius:0 12px 12px 0}

/* Responsive */
@media(max-width:640px){
  body{padding:12px}
  .grid{grid-template-columns:repeat(2,1fr);gap:8px}
  .card .value{font-size:18px}
  .wheel-grid{grid-template-columns:1fr}
  table{font-size:12px}
  th,td{padding:8px 10px}
  .compare{grid-template-columns:1fr;gap:8px}
  .compare-arrow{transform:rotate(90deg)}
}
</style>
</head>
<body>

<div id="lock-screen">
<h1>ğŸ”’</h1>
<input type="password" id="pwd" maxlength="4" placeholder="Â·Â·Â·Â·" autofocus>
<div class="error" id="pwd-error"></div>
</div>

<div id="dashboard">
<div class="header">
<h1>ğŸ´ Wheel Strategy Dashboard</h1>
<p class="sub">Theta Gang æ”¶ç§Ÿè¿½è¸ª Â· <span id="update-date">â€”</span></p>
</div>

<div class="nav" id="nav">
<button class="active" data-tab="overview">æ€»è§ˆ</button>
<button data-tab="wheel">Wheel è¿½è¸ª</button>
<button data-tab="cc">Covered Calls</button>
<button data-tab="csp">Cash-Secured Puts</button>
<button data-tab="closed">å·²å®ç°æ”¶ç›Š</button>
<button data-tab="idle">é—²ç½®ä»“ä½</button>
<button data-tab="decision">ğŸ¯ å†³ç­–</button>
<button data-tab="optimize">ä¼˜åŒ–æ–¹æ¡ˆ</button>
</div>

<!-- Overview -->
<div class="section active" id="tab-overview">
<div class="grid" id="summary-cards"></div>
<div class="sh"><h2>ğŸ”„ Wheel çŠ¶æ€ä¸€è§ˆ</h2></div>
<div class="wheel-grid" id="wheel-overview"></div>
</div>

<!-- Wheel Tracker -->
<div class="section" id="tab-wheel">
<div class="phase-flow">
<div class="phase-step step-csp">Sell Put</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign æ¥è‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-cc">Sell Call</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign å‡ºè‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-csp">Sell Put â™»ï¸</div>
</div>
<div class="wheel-grid" id="wheel-cards"></div>
</div>

<!-- CC -->
<div class="section" id="tab-cc">
<div class="sh"><h2>ğŸ“Š Covered Call æŒä»“</h2><span class="count" id="cc-count">0</span></div>
<table id="cc-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>æˆæœ¬</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- CSP -->
<div class="section" id="tab-csp">
<div class="sh"><h2>ğŸ’ Cash-Secured Put æŒä»“</h2><span class="count" id="csp-count">0</span></div>
<table id="csp-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>ä¿è¯é‡‘</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Closed -->
<div class="section" id="tab-closed">
<div class="grid" id="realized-cards"></div>
<div class="sh"><h2>ğŸ’° å·²å¹³ä»“è®°å½•</h2><span class="count" id="closed-count">0</span></div>
<table id="closed-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>å¼€ä»“</th><th>å¹³ä»“</th><th>å¤©æ•°</th><th>æƒåˆ©é‡‘</th><th>ç»“æœ</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Idle -->
<div class="section" id="tab-idle">
<div class="sh"><h2>ğŸ’¤ æœªå¼€ä»“ä½ï¼ˆé—²ç½®èµ„é‡‘ï¼‰</h2></div>
<table id="idle-table"><thead><tr>
<th>æ ‡çš„</th><th>è‚¡æ•°</th><th>å‡ä»·</th><th>å¸‚å€¼</th><th>å¯å¼€CC</th><th>å¤‡æ³¨</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Decision -->
<div class="section" id="tab-decision">
<div class="grid" id="decision-summary"></div>

<div class="sh"><h2>âš¡ æœ¬å‘¨æ“ä½œå»ºè®®</h2></div>
<div id="weekly-plan" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>

<div class="sh"><h2>ğŸ“Š 80% æ­¢ç›ˆè¿½è¸ª</h2><span class="count" id="profit-count">0</span></div>
<table id="profit-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>å¼€ä»“æƒåˆ©é‡‘</th><th>å½“å‰ä»·å€¼</th><th>ç›ˆåˆ©%</th><th>ä¿¡å·</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>â° åˆ°æœŸæé†’</h2><span class="count" id="expiry-count">0</span></div>
<table id="expiry-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>çŠ¶æ€</th><th>å»ºè®®</th><th>ä¸‹ä¸€æ­¥</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ¯ ä¸‹å‘¨æœ€ä¼˜ CSP å€™é€‰</h2><span class="count" id="csp-cand-count">0</span></div>
<table id="csp-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th><th>è¯„åˆ†</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“ˆ CC å¼€ä»“å€™é€‰ï¼ˆæœªè¦†ç›–æŒä»“ï¼‰</h2><span class="count" id="cc-cand-count">0</span></div>
<table id="cc-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“Š IV æ’è¡Œ</h2></div>
<div class="grid" id="iv-ranking-grid"></div>

<div class="sh"><h2>ğŸ’° èµ„é‡‘æ•ˆç‡</h2></div>
<div class="grid" id="capital-eff-grid"></div>
</div>

<!-- Optimize -->
<div class="section" id="tab-optimize">
<div class="note-box">é›†ä¸­åˆ°é«˜ IV æ ‡çš„ï¼Œæœ€å¤§åŒ– Wheel æ”¶ç§Ÿæ•ˆç‡ã€‚çŸ­å‘¨æœŸ 5-7 DTE ä¼˜å…ˆã€‚</div>
<div class="sh"><h2>ğŸ”„ æ“ä½œè¿›åº¦</h2></div>
<div id="opt-changes" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>
<div class="sh"><h2>ğŸ“ˆ å½“å‰ vs ä¼˜åŒ–å</h2></div>
<div class="compare">
<div class="compare-box"><div class="sub">å½“å‰å¹´åŒ–æ”¶å…¥</div><div class="big yellow" id="cur-income">â€”</div><div class="sub" id="cur-yield">â€”</div></div>
<div class="compare-arrow">â†’</div>
<div class="compare-box"><div class="sub">ä¼˜åŒ–åå¹´åŒ–æ”¶å…¥</div><div class="big green" id="opt-income">â€”</div><div class="sub" id="opt-yield">â€”</div></div>
</div>
</div>
</div>

<script>
const ENC = {"salt":"EkEeWoYWMhrRqIK1HYeDQg==","iv":"rxAY+hFyTxJtA9dq","tag":"EnHZDJ454VAXNcTI290RWA==","data":"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"};

function b64(s){return Uint8Array.from(atob(s),c=>c.charCodeAt(0))}

async function decrypt(pwd){
  const enc=new TextEncoder();
  const km=await crypto.subtle.importKey('raw',enc.encode(pwd),{name:'PBKDF2'},false,['deriveKey']);
  const key=await crypto.subtle.deriveKey({name:'PBKDF2',salt:b64(ENC.salt),iterations:100000,hash:'SHA-256'},km,{name:'AES-GCM',length:256},false,['decrypt']);
  const ct=b64(ENC.data),tag=b64(ENC.tag);
  const combined=new Uint8Array(ct.length+tag.length);
  combined.set(ct);combined.set(tag,ct.length);
  return JSON.parse(new TextDecoder().decode(await crypto.subtle.decrypt({name:'AES-GCM',iv:b64(ENC.iv)},key,combined)));
}

document.getElementById('pwd').addEventListener('input',async function(){
  if(this.value.length===4){
    try{
      const data=await decrypt(this.value);
      document.getElementById('lock-screen').style.display='none';
      document.getElementById('dashboard').style.display='block';
      render(data);
    }catch(e){
      document.getElementById('pwd-error').textContent='å¯†ç é”™è¯¯';
      this.value='';
    }
  }
});

// Tab navigation
document.getElementById('nav').addEventListener('click',e=>{
  if(e.target.tagName!=='BUTTON')return;
  document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  e.target.classList.add('active');
  document.getElementById('tab-'+e.target.dataset.tab).classList.add('active');
});

const fmt=n=>'$'+n.toLocaleString('en-US',{minimumFractionDigits:0,maximumFractionDigits:0});
const fmtPct=n=>n.toFixed(1)+'%';
const days=(a,b)=>Math.round((new Date(b)-new Date(a))/864e5);

function dteTag(dte,total){
  const pct=Math.max(0,Math.min(100,(1-dte/total)*100));
  let color=dte<=3?'var(--red)':dte<=7?'var(--yellow)':'var(--green)';
  return `<div>${dte}å¤©</div><div class="dte-bar"><div class="dte-fill" style="width:${pct}%;background:${color}"></div></div>`;
}

function statusTag(text,type){return `<span class="tag tag-${type}">${text}</span>`}

function render(D){
  const today=D.updatedAt;
  document.getElementById('update-date').textContent=today;

  // === Summary ===
  let totalCCPremium=0,totalCSPPremium=0,totalRealized=0,totalCCCost=0,totalCSPCollateral=0,totalIdleCost=0;
  D.ccPositions.forEach(p=>{totalCCPremium+=p.premium;totalCCCost+=p.costPerShare*100});
  D.cspPositions.forEach(p=>{totalCSPPremium+=p.premium;totalCSPCollateral+=p.collateral});
  D.closedTrades.forEach(t=>totalRealized+=t.premium);
  D.idlePositions.forEach(p=>totalIdleCost+=p.shares*p.cost);

  const activePremium=totalCCPremium+totalCSPPremium;
  const totalCap=totalCCCost+totalCSPCollateral+totalIdleCost;
  const daysYTD=days('2026-01-01',today);
  const annRealized=daysYTD>0?totalRealized*(365/daysYTD):0;

  const cards=[
    {label:'æ´»è·ƒæƒåˆ©é‡‘',value:fmt(Math.round(activePremium)),cls:'green',sub:`CC ${fmt(Math.round(totalCCPremium))} + CSP ${fmt(Math.round(totalCSPPremium))}`},
    {label:'YTD å·²å®ç°',value:fmt(Math.round(totalRealized)),cls:'green',sub:`${D.closedTrades.length}ç¬” Â· å¹´åŒ–æ¨ç®— ${fmt(Math.round(annRealized))}`},
    {label:'æ´»è·ƒCC',value:D.ccPositions.length+'å¼ ',cls:'cyan',sub:fmt(Math.round(totalCCCost))+' è¦†ç›–'},
    {label:'æ´»è·ƒCSP',value:D.cspPositions.length+'å¼ ',cls:'purple',sub:fmt(Math.round(totalCSPCollateral))+' ä¿è¯é‡‘'},
    {label:'Wheel æ ‡çš„',value:D.wheelCycles.length+'ä¸ª',cls:'blue',sub:'CSP '+D.wheelCycles.filter(w=>w.phase==='csp').length+' Â· CC '+D.wheelCycles.filter(w=>w.phase.startsWith('cc')).length},
    {label:'é—²ç½®èµ„é‡‘',value:fmt(Math.round(totalIdleCost)),cls:'yellow',sub:D.idlePositions.length+'ä¸ªä»“ä½'}
  ];
  const sc=document.getElementById('summary-cards');
  cards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
    sc.appendChild(d);
  });

  // === Wheel Overview (on overview tab) ===
  renderWheelCards(D.wheelCycles,'wheel-overview');

  // === Wheel Tracker tab ===
  renderWheelCards(D.wheelCycles,'wheel-cards');

  // === CC Table ===
  document.getElementById('cc-count').textContent=D.ccPositions.length+'å¼ ';
  const ccTb=document.querySelector('#cc-table tbody');
  D.ccPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const cost100=p.costPerShare*100;
    const yPer=(p.premium/cost100)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='green'}
    else if(ann>15){st='æ­£å¸¸';sc2='green'}
    else{st='åä½';sc2='yellow'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(Math.round(cost100))}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    ccTb.appendChild(tr);
  });

  // === CSP Table ===
  document.getElementById('csp-count').textContent=D.cspPositions.length+'å¼ ';
  const cspTb=document.querySelector('#csp-table tbody');
  D.cspPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const yPer=(p.premium/p.collateral)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='purple'}
    else{st='æ­£å¸¸';sc2='green'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(p.collateral)}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    cspTb.appendChild(tr);
  });

  // === Closed Trades ===
  document.getElementById('closed-count').textContent=D.closedTrades.length+'ç¬”';
  const rCards=[
    {label:'YTD å·²å®ç°æ”¶ç›Š',value:fmt(Math.round(totalRealized)),cls:'green'},
    {label:'å·²å¹³ä»“ç¬”æ•°',value:D.closedTrades.length+'ç¬”',cls:'blue'},
    {label:'å¹´åŒ–æ¨ç®—',value:fmt(Math.round(annRealized)),cls:'green'}
  ];
  const rc=document.getElementById('realized-cards');
  rCards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>`;
    rc.appendChild(d);
  });
  const ctb=document.querySelector('#closed-table tbody');
  D.closedTrades.forEach(t=>{
    const d=days(t.openDate,t.closeDate);
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${t.ticker}</td><td>${statusTag(t.type,t.type==='CC'?'cyan':'purple')}</td><td>$${t.strike}</td><td>${t.openDate.slice(5)}</td><td>${t.closeDate.slice(5)}</td><td>${d}å¤©</td><td class="green">${fmt(t.premium)}</td><td>${statusTag(t.assigned?'è¢«Assign':'åˆ°æœŸå½’é›¶',t.assigned?'yellow':'green')}</td>`;
    ctb.appendChild(tr);
  });

  // === Idle ===
  const itb=document.querySelector('#idle-table tbody');
  D.idlePositions.forEach(p=>{
    const mv=p.shares*p.cost;
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>${p.shares}</td><td>$${p.cost}</td><td>${fmt(Math.round(mv))}</td><td>${p.canCC?statusTag('å¯ä»¥','green'):statusTag('ä¸è¶³100è‚¡','red')}</td><td style="color:var(--dim)">${p.note}</td>`;
    itb.appendChild(tr);
  });

  // === Decision Tab ===
  if(D.decision){
    const dec=D.decision;

    // Summary cards
    const dsc=document.getElementById('decision-summary');
    const ce=dec.capitalEfficiency||{};
    const dCards=[
      {label:'èµ„é‡‘åˆ©ç”¨ç‡',value:fmtPct(ce.utilization||0),cls:ce.utilization>60?'green':'yellow',sub:`éƒ¨ç½² ${fmt(ce.deployedCapital||0)} / æ€»è®¡ ${fmt(ce.totalCapital||0)}`},
      {label:'å¹´åŒ–æ”¶ç§Ÿæ”¶å…¥',value:fmt(ce.totalAnnualPremium||0),cls:'green',sub:`CC ${fmt(ce.ccAnnualPremium||0)} + CSP ${fmt(ce.cspAnnualPremium||0)}`},
      {label:'ç»„åˆå¹´åŒ–æ”¶ç›Šç‡',value:fmtPct(ce.totalYield||0),cls:ce.totalYield>20?'green':'yellow',sub:`å·¥ä½œèµ„é‡‘å¹´åŒ– ${fmtPct(ce.workingYield||0)}`},
      {label:'æ­»é’±å æ¯”',value:fmtPct(ce.deadMoneyPct||0),cls:ce.deadMoneyPct>10?'red':'green',sub:fmt(ce.deadMoney||0)+' é—²ç½®'},
      {label:'åˆ°æœŸæé†’',value:(dec.expiringAlerts||[]).length+'ä¸ª',cls:'yellow',sub:'æœ¬å‘¨éœ€å…³æ³¨'},
      {label:'CSP å€™é€‰',value:(dec.cspCandidates||[]).length+'ä¸ª',cls:'purple',sub:'ä¸‹å‘¨å¯å¼€ä»“'},
    ];
    dCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
      dsc.appendChild(d);
    });

    // Weekly plan
    const wp=document.getElementById('weekly-plan');
    const plans=dec.weeklyPlan||[];
    if(plans.length===0){
      wp.innerHTML='<div style="color:var(--dim);padding:8px">æš‚æ— æ“ä½œå»ºè®®</div>';
    }else{
      plans.forEach(p=>{
        const d=document.createElement('div');d.className='opt-item';
        const urgCls=p.urgency==='high'?'active':p.urgency==='medium'?'pending':'done';
        const urgLabel=p.urgency==='high'?'ç´§æ€¥':p.urgency==='medium'?'å…³æ³¨':'å»ºè®®';
        const catIcon={expiry:'â°',opportunity:'ğŸ¯',efficiency:'ğŸ’°',profit:'ğŸ¯',risk:'âš ï¸'}[p.category]||'ğŸ“‹';
        d.innerHTML=`<span class="opt-badge ${urgCls}">${urgLabel}</span><span>${catIcon} ${p.action}</span>${p.detail?'<div style="color:var(--dim);font-size:11px;margin-left:66px">â†’ '+p.detail+'</div>':''}`;
        wp.appendChild(d);
      });
    }

    // Profit tracking (80% take-profit)
    const pa=dec.profitAlerts||[];
    document.getElementById('profit-count').textContent=pa.length+'ä¸ª';
    const ptb=document.querySelector('#profit-table tbody');
    if(pa.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="8" style="color:var(--dim);text-align:center">æ— å®æ—¶æ•°æ®ï¼ˆéœ€ Futu OpenD åœ¨çº¿æ—¶é‡‡é›†ï¼‰</td>';
      ptb.appendChild(tr);
    }else{
      pa.forEach(a=>{
        const tr=document.createElement('tr');
        const pctCls=a.profitPct>=80?'green':a.profitPct>=0?'blue':'red';
        const sigTag=a.signal==='take_profit'?statusTag('ğŸ¯ æ­¢ç›ˆ','green'):a.signal==='approaching'?statusTag('æ¥è¿‘','blue'):a.signal==='underwater'?statusTag('æµ®äº','red'):statusTag('æŒæœ‰','dim');
        tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td class="green">${fmt(a.entryPremium)}</td><td>${fmt(a.currentValue)}</td><td class="${pctCls}"><strong>${a.profitPct>0?'+':''}${a.profitPct}%</strong></td><td>${sigTag}<div style="font-size:11px;color:var(--dim);margin-top:2px">${a.message}</div></td>`;
        ptb.appendChild(tr);
      });
    }

    // Expiring alerts
    const ea=dec.expiringAlerts||[];
    document.getElementById('expiry-count').textContent=ea.length+'ä¸ª';
    const etb=document.querySelector('#expiry-table tbody');
    ea.forEach(a=>{
      const tr=document.createElement('tr');
      const urgTag=a.urgency==='high'?statusTag('ç´§æ€¥','red'):statusTag('å…³æ³¨','yellow');
      tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td>${a.dte}å¤©</td><td class="green">${fmt(a.premium)}</td><td>${urgTag}</td><td style="color:var(--dim);font-size:12px">${a.action}</td><td style="font-size:12px">${a.nextStep||''}</td>`;
      etb.appendChild(tr);
    });

    // CSP candidates
    const cc2=dec.cspCandidates||[];
    document.getElementById('csp-cand-count').textContent=cc2.length+'ä¸ª';
    const cctb=document.querySelector('#csp-cand-table tbody');
    cc2.forEach((c,i)=>{
      const tr=document.createElement('tr');
      const signal=c.annYield>=200?'ğŸ”¥':c.annYield>=100?'ğŸ’°':'ğŸ‘€';
      const scoreColor=c.score>=100?'green':c.score>=50?'yellow':'dim';
      tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong> ${signal}</td><td>${c.oi.toLocaleString()}</td><td>${statusTag(c.score,scoreColor)}</td>`;
      cctb.appendChild(tr);
    });

    // CC candidates
    const ccCand=dec.ccCandidates||[];
    document.getElementById('cc-cand-count').textContent=ccCand.length+'ä¸ª';
    const ccCandTb=document.querySelector('#cc-cand-table tbody');
    if(ccCand.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="9" style="color:var(--dim);text-align:center">æ‰€æœ‰æŒä»“å·²æœ‰ CC è¦†ç›– âœ…</td>';
      ccCandTb.appendChild(tr);
    }else{
      ccCand.forEach(c=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong></td><td>${c.oi.toLocaleString()}</td>`;
        ccCandTb.appendChild(tr);
      });
    }

    // IV rankings (with change indicator)
    const ivg=document.getElementById('iv-ranking-grid');
    const ivr=dec.ivRankings||[];
    ivr.slice(0,8).forEach(r=>{
      const d=document.createElement('div');d.className='card';
      const cls=r.iv>=70?'red':r.iv>=50?'yellow':'dim';
      const signal=r.iv>=70?'ğŸ”¥':r.iv>=50?'ğŸ’°':'';
      const change=r.ivChange!=null?(r.ivChange>0?`<span class="red">+${r.ivChange}%</span>`:`<span class="green">${r.ivChange}%</span>`):'';
      d.innerHTML=`<div class="label">${r.ticker} ${signal}</div><div class="value ${cls}">${r.iv}%</div><div class="sub-value">$${r.price} ${change}</div>`;
      ivg.appendChild(d);
    });

    // Capital efficiency
    const ceg=document.getElementById('capital-eff-grid');
    const ceCards=[
      {label:'æ€»èµ„æœ¬',value:fmt(ce.totalCapital||0),cls:'blue'},
      {label:'å·²éƒ¨ç½²',value:fmt(ce.deployedCapital||0),cls:'green',sub:fmtPct(ce.utilization||0)+' åˆ©ç”¨ç‡'},
      {label:'é—²ç½®èµ„é‡‘',value:fmt(ce.deadMoney||0),cls:ce.deadMoneyPct>10?'red':'dim'},
      {label:'ç°é‡‘',value:fmt(ce.cash||0),cls:'blue'},
    ];
    ceCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>${c.sub?'<div class="sub-value">'+c.sub+'</div>':''}`;
      ceg.appendChild(d);
    });
  }else{
    // No decision data
    const dsc=document.getElementById('decision-summary');
    dsc.innerHTML='<div class="card" style="grid-column:1/-1"><div class="label">å†³ç­–æ•°æ®</div><div class="value yellow">æœªç”Ÿæˆ</div><div class="sub-value">è¿è¡Œ python decision_engine.py ç”Ÿæˆ</div></div>';
  }

  // === Optimize ===
  const oc=document.getElementById('opt-changes');
  D.optChanges.forEach(c=>{
    const d=document.createElement('div');d.className='opt-item';
    d.innerHTML=`<span class="opt-badge ${c.cls}">${c.action}</span><span>${c.detail}</span>`;
    oc.appendChild(d);
  });

  // Compare
  const ccAnnual=D.ccPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const cspAnnual=D.cspPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const curIncome=Math.round(ccAnnual+cspAnnual);
  const curYield=totalCap>0?(curIncome/totalCap*100):0;
  const optAI=D.optEstimates.reduce((s,e)=>s+e.monthlyPremium*12,0);
  const optTC=D.optEstimates.reduce((s,e)=>s+e.cost,0);
  document.getElementById('cur-income').textContent=fmt(curIncome);
  document.getElementById('cur-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(curYield);
  document.getElementById('opt-income').textContent=fmt(optAI);
  document.getElementById('opt-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(optTC>0?optAI/optTC*100:0);
}

function renderWheelCards(cycles,containerId){
  const container=document.getElementById(containerId);
  cycles.forEach(w=>{
    const d=document.createElement('div');
    d.className=`wheel-card phase-${w.phase}`;
    const phaseLabel={csp:'Sell Put',cc:'Sell Call','cc-exit':'æ¸…é€€ä¸­','cc-locked':'è¿œæœŸé”å®š'}[w.phase]||w.phase;
    const phaseTag={csp:'purple',cc:'green','cc-exit':'yellow','cc-locked':'red'}[w.phase]||'dim';
    d.innerHTML=`
      <div class="wc-header">
        <span class="wc-ticker">${w.ticker}</span>
        ${statusTag(phaseLabel,phaseTag)}
      </div>
      <div class="wc-detail">${w.detail}</div>
      <div class="wc-note" style="color:var(--dim)">${w.note}</div>
    `;
    container.appendChild(d);
  });
}
</script>
</body>
</html>
