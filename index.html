<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wheel Strategy Dashboard</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0a0e14;--card:#12171f;--border:#1e2733;--text:#c9d1d9;--dim:#6e7681;--green:#3fb950;--red:#f85149;--blue:#58a6ff;--yellow:#d29922;--purple:#bc8cff;--cyan:#39d2c0;--green-bg:rgba(63,185,80,.1);--red-bg:rgba(248,81,73,.1);--blue-bg:rgba(88,166,255,.1);--yellow-bg:rgba(210,153,34,.1);--purple-bg:rgba(188,140,255,.1);--cyan-bg:rgba(57,210,192,.1)}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','Segoe UI',sans-serif;padding:20px;max-width:1200px;margin:0 auto;line-height:1.5}
#lock-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;height:80vh;animation:fadeIn .5s}
#lock-screen h1{font-size:56px;margin-bottom:24px}
#lock-screen input{background:var(--card);border:2px solid var(--border);border-radius:12px;color:var(--text);font-size:28px;padding:14px 24px;width:200px;text-align:center;letter-spacing:10px;outline:none;transition:border-color .2s}
#lock-screen input:focus{border-color:var(--blue)}
#lock-screen .error{color:var(--red);font-size:13px;margin-top:8px;height:20px}
#dashboard{display:none;animation:fadeIn .6s}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

/* Header */
.header{margin-bottom:28px}
.header h1{font-size:26px;font-weight:700;background:linear-gradient(135deg,var(--blue),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:inline}
.header .sub{color:var(--dim);font-size:13px;margin-top:4px}

/* Nav tabs */
.nav{display:flex;gap:4px;margin-bottom:24px;border-bottom:1px solid var(--border);padding-bottom:0;overflow-x:auto}
.nav button{background:none;border:none;color:var(--dim);font-size:13px;padding:10px 16px;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap}
.nav button:hover{color:var(--text)}
.nav button.active{color:var(--blue);border-bottom-color:var(--blue)}

/* Sections */
.section{display:none}.section.active{display:block;animation:fadeIn .3s}

/* Summary grid */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-bottom:24px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;transition:transform .15s,border-color .15s}
.card:hover{transform:translateY(-2px);border-color:rgba(88,166,255,.3)}
.card .label{color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.card .value{font-size:22px;font-weight:700}
.card .sub-value{font-size:11px;color:var(--dim);margin-top:2px}
.green{color:var(--green)}.red{color:var(--red)}.blue{color:var(--blue)}.yellow{color:var(--yellow)}.purple{color:var(--purple)}.cyan{color:var(--cyan)}

/* Tables */
table{width:100%;border-collapse:collapse;background:var(--card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:16px;font-size:13px}
th{background:rgba(30,39,51,.8);color:var(--dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px;padding:10px 14px;text-align:left;font-weight:600}
td{padding:10px 14px;border-top:1px solid var(--border)}
tr:hover{background:rgba(88,166,255,.03)}
.ticker{font-weight:700;color:var(--text)}

/* Tags */
.tag{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600}
.tag-green{background:var(--green-bg);color:var(--green)}
.tag-red{background:var(--red-bg);color:var(--red)}
.tag-blue{background:var(--blue-bg);color:var(--blue)}
.tag-yellow{background:var(--yellow-bg);color:var(--yellow)}
.tag-purple{background:var(--purple-bg);color:var(--purple)}
.tag-cyan{background:var(--cyan-bg);color:var(--cyan)}
.tag-dim{background:rgba(110,118,129,.1);color:var(--dim)}

/* DTE bar */
.dte-bar{width:100%;height:4px;background:var(--border);border-radius:2px;overflow:hidden;margin-top:4px}
.dte-fill{height:100%;border-radius:2px;transition:width .3s}

/* Wheel tracker */
.wheel-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-bottom:24px}
.wheel-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;position:relative;overflow:hidden}
.wheel-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.wheel-card.phase-csp::before{background:linear-gradient(90deg,var(--purple),var(--blue))}
.wheel-card.phase-cc::before{background:linear-gradient(90deg,var(--green),var(--cyan))}
.wheel-card.phase-cc-exit::before{background:linear-gradient(90deg,var(--yellow),var(--red))}
.wheel-card.phase-cc-locked::before{background:linear-gradient(90deg,var(--red),var(--yellow))}
.wheel-card .wc-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.wheel-card .wc-ticker{font-size:18px;font-weight:700}
.wheel-card .wc-detail{color:var(--dim);font-size:12px}
.wheel-card .wc-note{font-size:12px;margin-top:4px}

/* Phase flow */
.phase-flow{display:flex;align-items:center;gap:6px;margin:20px 0}
.phase-step{padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;opacity:.3}
.phase-step.active{opacity:1}
.phase-step.step-csp{background:var(--purple-bg);color:var(--purple)}
.phase-step.step-assign{background:var(--yellow-bg);color:var(--yellow)}
.phase-step.step-cc{background:var(--green-bg);color:var(--green)}
.phase-arrow{color:var(--dim);font-size:10px;opacity:.4}

/* Section headers */
.sh{display:flex;align-items:center;gap:10px;margin:28px 0 14px;padding-bottom:10px;border-bottom:1px solid var(--border)}
.sh h2{font-size:15px;font-weight:600;color:var(--text)}
.sh .count{font-size:12px;color:var(--dim);background:var(--border);padding:2px 8px;border-radius:10px}

/* Opt changes */
.opt-item{display:flex;align-items:center;gap:10px;padding:8px 0;font-size:13px;border-bottom:1px solid var(--border)}
.opt-item:last-child{border-bottom:none}
.opt-badge{padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;min-width:56px;text-align:center}
.opt-badge.done{background:var(--green-bg);color:var(--green)}
.opt-badge.active{background:var(--blue-bg);color:var(--blue)}
.opt-badge.pending{background:var(--yellow-bg);color:var(--yellow)}

/* Compare */
.compare{display:grid;grid-template-columns:1fr 50px 1fr;gap:0;margin:20px 0}
.compare-box{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:24px;text-align:center}
.compare-arrow{display:flex;align-items:center;justify-content:center;font-size:24px;color:var(--blue)}
.compare-box .big{font-size:30px;font-weight:700;margin:8px 0}
.compare-box .sub{color:var(--dim);font-size:12px}

/* Note */
.note-box{background:var(--card);border-left:3px solid var(--yellow);padding:12px 16px;margin:16px 0;font-size:13px;color:var(--yellow);border-radius:0 12px 12px 0}

/* Responsive */
@media(max-width:640px){
  body{padding:12px}
  .grid{grid-template-columns:repeat(2,1fr);gap:8px}
  .card .value{font-size:18px}
  .wheel-grid{grid-template-columns:1fr}
  table{font-size:12px}
  th,td{padding:8px 10px}
  .compare{grid-template-columns:1fr;gap:8px}
  .compare-arrow{transform:rotate(90deg)}
}
</style>
</head>
<body>

<div id="lock-screen">
<h1>ğŸ”’</h1>
<input type="password" id="pwd" maxlength="4" placeholder="Â·Â·Â·Â·" autofocus>
<div class="error" id="pwd-error"></div>
</div>

<div id="dashboard">
<div class="header">
<h1>ğŸ´ Wheel Strategy Dashboard</h1>
<p class="sub">Theta Gang æ”¶ç§Ÿè¿½è¸ª Â· <span id="update-date">â€”</span></p>
</div>

<div class="nav" id="nav">
<button class="active" data-tab="overview">æ€»è§ˆ</button>
<button data-tab="wheel">Wheel è¿½è¸ª</button>
<button data-tab="cc">Covered Calls</button>
<button data-tab="csp">Cash-Secured Puts</button>
<button data-tab="closed">å·²å®ç°æ”¶ç›Š</button>
<button data-tab="idle">é—²ç½®ä»“ä½</button>
<button data-tab="decision">ğŸ¯ å†³ç­–</button>
<button data-tab="optimize">ä¼˜åŒ–æ–¹æ¡ˆ</button>
</div>

<!-- Overview -->
<div class="section active" id="tab-overview">
<div class="grid" id="summary-cards"></div>
<div class="sh"><h2>ğŸ”„ Wheel çŠ¶æ€ä¸€è§ˆ</h2></div>
<div class="wheel-grid" id="wheel-overview"></div>
</div>

<!-- Wheel Tracker -->
<div class="section" id="tab-wheel">
<div class="phase-flow">
<div class="phase-step step-csp">Sell Put</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign æ¥è‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-cc">Sell Call</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-assign">Assign å‡ºè‚¡</div><div class="phase-arrow">â†’</div>
<div class="phase-step step-csp">Sell Put â™»ï¸</div>
</div>
<div class="wheel-grid" id="wheel-cards"></div>
</div>

<!-- CC -->
<div class="section" id="tab-cc">
<div class="sh"><h2>ğŸ“Š Covered Call æŒä»“</h2><span class="count" id="cc-count">0</span></div>
<table id="cc-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>æˆæœ¬</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- CSP -->
<div class="section" id="tab-csp">
<div class="sh"><h2>ğŸ’ Cash-Secured Put æŒä»“</h2><span class="count" id="csp-count">0</span></div>
<table id="csp-table"><thead><tr>
<th>æ ‡çš„</th><th>Strike</th><th>å¼€ä»“</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>ä¿è¯é‡‘</th><th>æ”¶ç›Šç‡</th><th>å¹´åŒ–</th><th>çŠ¶æ€</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Closed -->
<div class="section" id="tab-closed">
<div class="grid" id="realized-cards"></div>
<div class="sh"><h2>ğŸ’° å·²å¹³ä»“è®°å½•</h2><span class="count" id="closed-count">0</span></div>
<table id="closed-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>å¼€ä»“</th><th>å¹³ä»“</th><th>å¤©æ•°</th><th>æƒåˆ©é‡‘</th><th>ç»“æœ</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Idle -->
<div class="section" id="tab-idle">
<div class="sh"><h2>ğŸ’¤ æœªå¼€ä»“ä½ï¼ˆé—²ç½®èµ„é‡‘ï¼‰</h2></div>
<table id="idle-table"><thead><tr>
<th>æ ‡çš„</th><th>è‚¡æ•°</th><th>å‡ä»·</th><th>å¸‚å€¼</th><th>å¯å¼€CC</th><th>å¤‡æ³¨</th>
</tr></thead><tbody></tbody></table>
</div>

<!-- Decision -->
<div class="section" id="tab-decision">
<div class="grid" id="decision-summary"></div>

<div class="sh"><h2>âš¡ æœ¬å‘¨æ“ä½œå»ºè®®</h2></div>
<div id="weekly-plan" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>

<div class="sh"><h2>ğŸ“Š 80% æ­¢ç›ˆè¿½è¸ª</h2><span class="count" id="profit-count">0</span></div>
<table id="profit-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>å¼€ä»“æƒåˆ©é‡‘</th><th>å½“å‰ä»·å€¼</th><th>ç›ˆåˆ©%</th><th>ä¿¡å·</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>â° åˆ°æœŸæé†’</h2><span class="count" id="expiry-count">0</span></div>
<table id="expiry-table"><thead><tr>
<th>æ ‡çš„</th><th>ç±»å‹</th><th>Strike</th><th>åˆ°æœŸ</th><th>DTE</th><th>æƒåˆ©é‡‘</th><th>çŠ¶æ€</th><th>å»ºè®®</th><th>ä¸‹ä¸€æ­¥</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ¯ ä¸‹å‘¨æœ€ä¼˜ CSP å€™é€‰</h2><span class="count" id="csp-cand-count">0</span></div>
<table id="csp-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th><th>è¯„åˆ†</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“ˆ CC å¼€ä»“å€™é€‰ï¼ˆæœªè¦†ç›–æŒä»“ï¼‰</h2><span class="count" id="cc-cand-count">0</span></div>
<table id="cc-cand-table"><thead><tr>
<th>æ ‡çš„</th><th>ç°ä»·</th><th>Strike</th><th>OTM%</th><th>DTE</th><th>IV</th><th>æƒåˆ©é‡‘</th><th>å¹´åŒ–</th><th>OI</th>
</tr></thead><tbody></tbody></table>

<div class="sh"><h2>ğŸ“Š IV æ’è¡Œ</h2></div>
<div class="grid" id="iv-ranking-grid"></div>

<div class="sh"><h2>ğŸ’° èµ„é‡‘æ•ˆç‡</h2></div>
<div class="grid" id="capital-eff-grid"></div>
</div>

<!-- Optimize -->
<div class="section" id="tab-optimize">
<div class="note-box">é›†ä¸­åˆ°é«˜ IV æ ‡çš„ï¼Œæœ€å¤§åŒ– Wheel æ”¶ç§Ÿæ•ˆç‡ã€‚çŸ­å‘¨æœŸ 5-7 DTE ä¼˜å…ˆã€‚</div>
<div class="sh"><h2>ğŸ”„ æ“ä½œè¿›åº¦</h2></div>
<div id="opt-changes" style="background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px 16px;margin-bottom:24px"></div>
<div class="sh"><h2>ğŸ“ˆ å½“å‰ vs ä¼˜åŒ–å</h2></div>
<div class="compare">
<div class="compare-box"><div class="sub">å½“å‰å¹´åŒ–æ”¶å…¥</div><div class="big yellow" id="cur-income">â€”</div><div class="sub" id="cur-yield">â€”</div></div>
<div class="compare-arrow">â†’</div>
<div class="compare-box"><div class="sub">ä¼˜åŒ–åå¹´åŒ–æ”¶å…¥</div><div class="big green" id="opt-income">â€”</div><div class="sub" id="opt-yield">â€”</div></div>
</div>
</div>
</div>

<script>
const ENC = {"salt":"dklY4qK5KVyPlhQ28uqELw==","iv":"tMN2FZquIOgiCp4d","tag":"TJ3uj7cgSshRBvjyCtYVbw==","data":"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"};

function b64(s){return Uint8Array.from(atob(s),c=>c.charCodeAt(0))}

async function decrypt(pwd){
  const enc=new TextEncoder();
  const km=await crypto.subtle.importKey('raw',enc.encode(pwd),{name:'PBKDF2'},false,['deriveKey']);
  const key=await crypto.subtle.deriveKey({name:'PBKDF2',salt:b64(ENC.salt),iterations:100000,hash:'SHA-256'},km,{name:'AES-GCM',length:256},false,['decrypt']);
  const ct=b64(ENC.data),tag=b64(ENC.tag);
  const combined=new Uint8Array(ct.length+tag.length);
  combined.set(ct);combined.set(tag,ct.length);
  return JSON.parse(new TextDecoder().decode(await crypto.subtle.decrypt({name:'AES-GCM',iv:b64(ENC.iv)},key,combined)));
}

document.getElementById('pwd').addEventListener('input',async function(){
  if(this.value.length===4){
    try{
      const data=await decrypt(this.value);
      document.getElementById('lock-screen').style.display='none';
      document.getElementById('dashboard').style.display='block';
      render(data);
    }catch(e){
      document.getElementById('pwd-error').textContent='å¯†ç é”™è¯¯';
      this.value='';
    }
  }
});

// Tab navigation
document.getElementById('nav').addEventListener('click',e=>{
  if(e.target.tagName!=='BUTTON')return;
  document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  e.target.classList.add('active');
  document.getElementById('tab-'+e.target.dataset.tab).classList.add('active');
});

const fmt=n=>'$'+n.toLocaleString('en-US',{minimumFractionDigits:0,maximumFractionDigits:0});
const fmtPct=n=>n.toFixed(1)+'%';
const days=(a,b)=>Math.round((new Date(b)-new Date(a))/864e5);

function dteTag(dte,total){
  const pct=Math.max(0,Math.min(100,(1-dte/total)*100));
  let color=dte<=3?'var(--red)':dte<=7?'var(--yellow)':'var(--green)';
  return `<div>${dte}å¤©</div><div class="dte-bar"><div class="dte-fill" style="width:${pct}%;background:${color}"></div></div>`;
}

function statusTag(text,type){return `<span class="tag tag-${type}">${text}</span>`}

function render(D){
  const today=D.updatedAt;
  document.getElementById('update-date').textContent=today;

  // === Summary ===
  let totalCCPremium=0,totalCSPPremium=0,totalRealized=0,totalCCCost=0,totalCSPCollateral=0,totalIdleCost=0;
  D.ccPositions.forEach(p=>{totalCCPremium+=p.premium;totalCCCost+=p.costPerShare*100});
  D.cspPositions.forEach(p=>{totalCSPPremium+=p.premium;totalCSPCollateral+=p.collateral});
  D.closedTrades.forEach(t=>totalRealized+=t.premium);
  D.idlePositions.forEach(p=>totalIdleCost+=p.shares*p.cost);

  const activePremium=totalCCPremium+totalCSPPremium;
  const totalCap=totalCCCost+totalCSPCollateral+totalIdleCost;
  const daysYTD=days('2026-01-01',today);
  const annRealized=daysYTD>0?totalRealized*(365/daysYTD):0;

  const cards=[
    {label:'æ´»è·ƒæƒåˆ©é‡‘',value:fmt(Math.round(activePremium)),cls:'green',sub:`CC ${fmt(Math.round(totalCCPremium))} + CSP ${fmt(Math.round(totalCSPPremium))}`},
    {label:'YTD å·²å®ç°',value:fmt(Math.round(totalRealized)),cls:'green',sub:`${D.closedTrades.length}ç¬” Â· å¹´åŒ–æ¨ç®— ${fmt(Math.round(annRealized))}`},
    {label:'æ´»è·ƒCC',value:D.ccPositions.length+'å¼ ',cls:'cyan',sub:fmt(Math.round(totalCCCost))+' è¦†ç›–'},
    {label:'æ´»è·ƒCSP',value:D.cspPositions.length+'å¼ ',cls:'purple',sub:fmt(Math.round(totalCSPCollateral))+' ä¿è¯é‡‘'},
    {label:'Wheel æ ‡çš„',value:D.wheelCycles.length+'ä¸ª',cls:'blue',sub:'CSP '+D.wheelCycles.filter(w=>w.phase==='csp').length+' Â· CC '+D.wheelCycles.filter(w=>w.phase.startsWith('cc')).length},
    {label:'é—²ç½®èµ„é‡‘',value:fmt(Math.round(totalIdleCost)),cls:'yellow',sub:D.idlePositions.length+'ä¸ªä»“ä½'}
  ];
  const sc=document.getElementById('summary-cards');
  cards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
    sc.appendChild(d);
  });

  // === Wheel Overview (on overview tab) ===
  renderWheelCards(D.wheelCycles,'wheel-overview');

  // === Wheel Tracker tab ===
  renderWheelCards(D.wheelCycles,'wheel-cards');

  // === CC Table ===
  document.getElementById('cc-count').textContent=D.ccPositions.length+'å¼ ';
  const ccTb=document.querySelector('#cc-table tbody');
  D.ccPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const cost100=p.costPerShare*100;
    const yPer=(p.premium/cost100)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='green'}
    else if(ann>15){st='æ­£å¸¸';sc2='green'}
    else{st='åä½';sc2='yellow'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(Math.round(cost100))}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    ccTb.appendChild(tr);
  });

  // === CSP Table ===
  document.getElementById('csp-count').textContent=D.cspPositions.length+'å¼ ';
  const cspTb=document.querySelector('#csp-table tbody');
  D.cspPositions.forEach(p=>{
    const totalDte=days(p.sellDate,p.expiry);
    const dte=days(today,p.expiry);
    const yPer=(p.premium/p.collateral)*100;
    const ann=totalDte>0?yPer*(365/totalDte):0;
    let st,sc2;
    if(dte<=0){st='å·²åˆ°æœŸ';sc2='dim'}
    else if(dte<=3){st='âš ï¸ å³å°†åˆ°æœŸ';sc2='yellow'}
    else if(ann>30){st='é«˜æ”¶ç›Š';sc2='purple'}
    else{st='æ­£å¸¸';sc2='green'}
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>$${p.strike}</td><td>${p.sellDate.slice(5)}</td><td>${p.expiry.slice(5)}</td><td>${dteTag(Math.max(0,dte),totalDte)}</td><td class="green">${fmt(p.premium)}</td><td>${fmt(p.collateral)}</td><td>${fmtPct(yPer)}</td><td><strong>${fmtPct(ann)}</strong></td><td>${statusTag(st,sc2)}</td>`;
    cspTb.appendChild(tr);
  });

  // === Closed Trades ===
  document.getElementById('closed-count').textContent=D.closedTrades.length+'ç¬”';
  const rCards=[
    {label:'YTD å·²å®ç°æ”¶ç›Š',value:fmt(Math.round(totalRealized)),cls:'green'},
    {label:'å·²å¹³ä»“ç¬”æ•°',value:D.closedTrades.length+'ç¬”',cls:'blue'},
    {label:'å¹´åŒ–æ¨ç®—',value:fmt(Math.round(annRealized)),cls:'green'}
  ];
  const rc=document.getElementById('realized-cards');
  rCards.forEach(c=>{
    const d=document.createElement('div');d.className='card';
    d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>`;
    rc.appendChild(d);
  });
  const ctb=document.querySelector('#closed-table tbody');
  D.closedTrades.forEach(t=>{
    const d=days(t.openDate,t.closeDate);
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${t.ticker}</td><td>${statusTag(t.type,t.type==='CC'?'cyan':'purple')}</td><td>$${t.strike}</td><td>${t.openDate.slice(5)}</td><td>${t.closeDate.slice(5)}</td><td>${d}å¤©</td><td class="green">${fmt(t.premium)}</td><td>${statusTag(t.assigned?'è¢«Assign':'åˆ°æœŸå½’é›¶',t.assigned?'yellow':'green')}</td>`;
    ctb.appendChild(tr);
  });

  // === Idle ===
  const itb=document.querySelector('#idle-table tbody');
  D.idlePositions.forEach(p=>{
    const mv=p.shares*p.cost;
    const tr=document.createElement('tr');
    tr.innerHTML=`<td class="ticker">${p.ticker}</td><td>${p.shares}</td><td>$${p.cost}</td><td>${fmt(Math.round(mv))}</td><td>${p.canCC?statusTag('å¯ä»¥','green'):statusTag('ä¸è¶³100è‚¡','red')}</td><td style="color:var(--dim)">${p.note}</td>`;
    itb.appendChild(tr);
  });

  // === Decision Tab ===
  if(D.decision){
    const dec=D.decision;

    // Summary cards
    const dsc=document.getElementById('decision-summary');
    const ce=dec.capitalEfficiency||{};
    const dCards=[
      {label:'èµ„é‡‘åˆ©ç”¨ç‡',value:fmtPct(ce.utilization||0),cls:ce.utilization>60?'green':'yellow',sub:`éƒ¨ç½² ${fmt(ce.deployedCapital||0)} / æ€»è®¡ ${fmt(ce.totalCapital||0)}`},
      {label:'å¹´åŒ–æ”¶ç§Ÿæ”¶å…¥',value:fmt(ce.totalAnnualPremium||0),cls:'green',sub:`CC ${fmt(ce.ccAnnualPremium||0)} + CSP ${fmt(ce.cspAnnualPremium||0)}`},
      {label:'ç»„åˆå¹´åŒ–æ”¶ç›Šç‡',value:fmtPct(ce.totalYield||0),cls:ce.totalYield>20?'green':'yellow',sub:`å·¥ä½œèµ„é‡‘å¹´åŒ– ${fmtPct(ce.workingYield||0)}`},
      {label:'æ­»é’±å æ¯”',value:fmtPct(ce.deadMoneyPct||0),cls:ce.deadMoneyPct>10?'red':'green',sub:fmt(ce.deadMoney||0)+' é—²ç½®'},
      {label:'åˆ°æœŸæé†’',value:(dec.expiringAlerts||[]).length+'ä¸ª',cls:'yellow',sub:'æœ¬å‘¨éœ€å…³æ³¨'},
      {label:'CSP å€™é€‰',value:(dec.cspCandidates||[]).length+'ä¸ª',cls:'purple',sub:'ä¸‹å‘¨å¯å¼€ä»“'},
    ];
    dCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div><div class="sub-value">${c.sub||''}</div>`;
      dsc.appendChild(d);
    });

    // Weekly plan
    const wp=document.getElementById('weekly-plan');
    const plans=dec.weeklyPlan||[];
    if(plans.length===0){
      wp.innerHTML='<div style="color:var(--dim);padding:8px">æš‚æ— æ“ä½œå»ºè®®</div>';
    }else{
      plans.forEach(p=>{
        const d=document.createElement('div');d.className='opt-item';
        const urgCls=p.urgency==='high'?'active':p.urgency==='medium'?'pending':'done';
        const urgLabel=p.urgency==='high'?'ç´§æ€¥':p.urgency==='medium'?'å…³æ³¨':'å»ºè®®';
        const catIcon={expiry:'â°',opportunity:'ğŸ¯',efficiency:'ğŸ’°',profit:'ğŸ¯',risk:'âš ï¸'}[p.category]||'ğŸ“‹';
        d.innerHTML=`<span class="opt-badge ${urgCls}">${urgLabel}</span><span>${catIcon} ${p.action}</span>${p.detail?'<div style="color:var(--dim);font-size:11px;margin-left:66px">â†’ '+p.detail+'</div>':''}`;
        wp.appendChild(d);
      });
    }

    // Profit tracking (80% take-profit)
    const pa=dec.profitAlerts||[];
    document.getElementById('profit-count').textContent=pa.length+'ä¸ª';
    const ptb=document.querySelector('#profit-table tbody');
    if(pa.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="8" style="color:var(--dim);text-align:center">æ— å®æ—¶æ•°æ®ï¼ˆéœ€ Futu OpenD åœ¨çº¿æ—¶é‡‡é›†ï¼‰</td>';
      ptb.appendChild(tr);
    }else{
      pa.forEach(a=>{
        const tr=document.createElement('tr');
        const pctCls=a.profitPct>=80?'green':a.profitPct>=0?'blue':'red';
        const sigTag=a.signal==='take_profit'?statusTag('ğŸ¯ æ­¢ç›ˆ','green'):a.signal==='approaching'?statusTag('æ¥è¿‘','blue'):a.signal==='underwater'?statusTag('æµ®äº','red'):statusTag('æŒæœ‰','dim');
        tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td class="green">${fmt(a.entryPremium)}</td><td>${fmt(a.currentValue)}</td><td class="${pctCls}"><strong>${a.profitPct>0?'+':''}${a.profitPct}%</strong></td><td>${sigTag}<div style="font-size:11px;color:var(--dim);margin-top:2px">${a.message}</div></td>`;
        ptb.appendChild(tr);
      });
    }

    // Expiring alerts
    const ea=dec.expiringAlerts||[];
    document.getElementById('expiry-count').textContent=ea.length+'ä¸ª';
    const etb=document.querySelector('#expiry-table tbody');
    ea.forEach(a=>{
      const tr=document.createElement('tr');
      const urgTag=a.urgency==='high'?statusTag('ç´§æ€¥','red'):statusTag('å…³æ³¨','yellow');
      tr.innerHTML=`<td class="ticker">${a.ticker}</td><td>${statusTag(a.type,a.type==='CC'?'cyan':'purple')}</td><td>$${a.strike}</td><td>${a.expiry.slice(5)}</td><td>${a.dte}å¤©</td><td class="green">${fmt(a.premium)}</td><td>${urgTag}</td><td style="color:var(--dim);font-size:12px">${a.action}</td><td style="font-size:12px">${a.nextStep||''}</td>`;
      etb.appendChild(tr);
    });

    // CSP candidates
    const cc2=dec.cspCandidates||[];
    document.getElementById('csp-cand-count').textContent=cc2.length+'ä¸ª';
    const cctb=document.querySelector('#csp-cand-table tbody');
    cc2.forEach((c,i)=>{
      const tr=document.createElement('tr');
      const signal=c.annYield>=200?'ğŸ”¥':c.annYield>=100?'ğŸ’°':'ğŸ‘€';
      const scoreColor=c.score>=100?'green':c.score>=50?'yellow':'dim';
      tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong> ${signal}</td><td>${c.oi.toLocaleString()}</td><td>${statusTag(c.score,scoreColor)}</td>`;
      cctb.appendChild(tr);
    });

    // CC candidates
    const ccCand=dec.ccCandidates||[];
    document.getElementById('cc-cand-count').textContent=ccCand.length+'ä¸ª';
    const ccCandTb=document.querySelector('#cc-cand-table tbody');
    if(ccCand.length===0){
      const tr=document.createElement('tr');
      tr.innerHTML='<td colspan="9" style="color:var(--dim);text-align:center">æ‰€æœ‰æŒä»“å·²æœ‰ CC è¦†ç›– âœ…</td>';
      ccCandTb.appendChild(tr);
    }else{
      ccCand.forEach(c=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td class="ticker">${c.ticker}</td><td>$${c.price}</td><td>$${c.strike}</td><td>${c.otmPct}%</td><td>${c.dte}å¤©</td><td>${c.iv}%</td><td class="green">$${c.premium}</td><td><strong>${c.annYield}%</strong></td><td>${c.oi.toLocaleString()}</td>`;
        ccCandTb.appendChild(tr);
      });
    }

    // IV rankings (with change indicator)
    const ivg=document.getElementById('iv-ranking-grid');
    const ivr=dec.ivRankings||[];
    ivr.slice(0,8).forEach(r=>{
      const d=document.createElement('div');d.className='card';
      const cls=r.iv>=70?'red':r.iv>=50?'yellow':'dim';
      const signal=r.iv>=70?'ğŸ”¥':r.iv>=50?'ğŸ’°':'';
      const change=r.ivChange!=null?(r.ivChange>0?`<span class="red">+${r.ivChange}%</span>`:`<span class="green">${r.ivChange}%</span>`):'';
      d.innerHTML=`<div class="label">${r.ticker} ${signal}</div><div class="value ${cls}">${r.iv}%</div><div class="sub-value">$${r.price} ${change}</div>`;
      ivg.appendChild(d);
    });

    // Capital efficiency
    const ceg=document.getElementById('capital-eff-grid');
    const ceCards=[
      {label:'æ€»èµ„æœ¬',value:fmt(ce.totalCapital||0),cls:'blue'},
      {label:'å·²éƒ¨ç½²',value:fmt(ce.deployedCapital||0),cls:'green',sub:fmtPct(ce.utilization||0)+' åˆ©ç”¨ç‡'},
      {label:'é—²ç½®èµ„é‡‘',value:fmt(ce.deadMoney||0),cls:ce.deadMoneyPct>10?'red':'dim'},
      {label:'ç°é‡‘',value:fmt(ce.cash||0),cls:'blue'},
    ];
    ceCards.forEach(c=>{
      const d=document.createElement('div');d.className='card';
      d.innerHTML=`<div class="label">${c.label}</div><div class="value ${c.cls}">${c.value}</div>${c.sub?'<div class="sub-value">'+c.sub+'</div>':''}`;
      ceg.appendChild(d);
    });
  }else{
    // No decision data
    const dsc=document.getElementById('decision-summary');
    dsc.innerHTML='<div class="card" style="grid-column:1/-1"><div class="label">å†³ç­–æ•°æ®</div><div class="value yellow">æœªç”Ÿæˆ</div><div class="sub-value">è¿è¡Œ python decision_engine.py ç”Ÿæˆ</div></div>';
  }

  // === Optimize ===
  const oc=document.getElementById('opt-changes');
  D.optChanges.forEach(c=>{
    const d=document.createElement('div');d.className='opt-item';
    d.innerHTML=`<span class="opt-badge ${c.cls}">${c.action}</span><span>${c.detail}</span>`;
    oc.appendChild(d);
  });

  // Compare
  const ccAnnual=D.ccPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const cspAnnual=D.cspPositions.reduce((s,p)=>{const d=days(p.sellDate,p.expiry);return s+(d>0?(p.premium/d)*365:0)},0);
  const curIncome=Math.round(ccAnnual+cspAnnual);
  const curYield=totalCap>0?(curIncome/totalCap*100):0;
  const optAI=D.optEstimates.reduce((s,e)=>s+e.monthlyPremium*12,0);
  const optTC=D.optEstimates.reduce((s,e)=>s+e.cost,0);
  document.getElementById('cur-income').textContent=fmt(curIncome);
  document.getElementById('cur-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(curYield);
  document.getElementById('opt-income').textContent=fmt(optAI);
  document.getElementById('opt-yield').textContent='ç»„åˆå¹´åŒ– '+fmtPct(optTC>0?optAI/optTC*100:0);
}

function renderWheelCards(cycles,containerId){
  const container=document.getElementById(containerId);
  cycles.forEach(w=>{
    const d=document.createElement('div');
    d.className=`wheel-card phase-${w.phase}`;
    const phaseLabel={csp:'Sell Put',cc:'Sell Call','cc-exit':'æ¸…é€€ä¸­','cc-locked':'è¿œæœŸé”å®š'}[w.phase]||w.phase;
    const phaseTag={csp:'purple',cc:'green','cc-exit':'yellow','cc-locked':'red'}[w.phase]||'dim';
    d.innerHTML=`
      <div class="wc-header">
        <span class="wc-ticker">${w.ticker}</span>
        ${statusTag(phaseLabel,phaseTag)}
      </div>
      <div class="wc-detail">${w.detail}</div>
      <div class="wc-note" style="color:var(--dim)">${w.note}</div>
    `;
    container.appendChild(d);
  });
}
</script>
</body>
</html>
